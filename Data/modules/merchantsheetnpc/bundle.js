!function n(i,o,a){function s(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=o[t]={exports:{}},i[t][0].call(r.exports,function(e){return s(i[t][1][e]||e)},r,r.exports,n,i,o,a)}return o[t].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.Assert=void 0;const i=n(e("assert"));n="merchantsheetnpc";r.default={ModuleName:n,Socket:"module."+n,IsModule:!0};r.Assert=e=>(0,i.default)(e)},{assert:16}],2:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});const i=n(e("./Globals"));r.default=async()=>{i.default.ModuleName;return loadTemplates([])}},{"./Globals":1}],3:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});const a=n(e("../Globals")),s=n(e("color"));class l{constructor(){}static GetCurrentTime(){return`[${(new Date).toLocaleTimeString()}] `}static LogWithOptions(e,t=(0,s.default)("white"),r=!1,...n){const i=u(l.GetCurrentTime(),(0,s.default)("gray"),!1);var o=u(a.default.ModuleName+" ",(0,s.default)("cyan"),!0),e=u(e,t,r);null===n||0<n.length?console.log(i.str+o.str+e.str,...i.params.concat(o.params,e.params),n):console.log(i.str+o.str+e.str,...i.params.concat(o.params,e.params))}static Log(e,...t){this.LogWithOptions(e,(0,s.default)("white"),!1,t)}static Err(e){l.LogWithOptions(e,(0,s.default)("orange"))}static Warn(e){l.LogWithOptions(e,(0,s.default)("yellow"))}static Ok(e){l.LogWithOptions(e,(0,s.default)("green"))}}const u=(e,t,r)=>({str:"%c"+e+"%c",params:["color: "+t.hex()+";"+(r?"font-weight: bold;":""),"color: unset; font-weight: unset;"]});r.default=l},{"../Globals":1,color:28}],4:[function(e,u,t){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(e("../Globals")),s=o(e("./Logger"));class l{constructor(){this.SettingsInit=!1,s.default.Ok("Loading configuration settings.");const e=game;this.SettingsList=[["buyChat",{name:"Display chat message for purchases?",hint:"If enabled, a chat message will display purchases of items from the Merchant sheet.",scope:"world",config:!0,default:!0,type:Boolean}],["showStackWeight",{name:"Show Stack Weight?",hint:"If enabled, shows the weight of the entire stack next to the item weight",scope:"world",config:!0,default:!1,type:Boolean}],["reduceUpdateVerbosity",{name:"Reduce Update Shop Verbosity",hint:"If enabled, no notifications will be created every time an item is added to the shop.",scope:"world",config:!0,default:!0,type:Boolean}],["allowNoGM",{name:"Allow transactions without GM",hint:"If enabled, transactions can happen even without the GM is active.",scope:"world",config:!0,default:!1,type:Boolean}],["itemCompendium",{name:e.i18n.format("MERCHANTNPC.pickItemCompendium"),hint:e.i18n.format("MERCHANTNPC.pickItemCompendium_hint"),scope:"world",config:!0,type:String,choices:l.getCompendiumnsChoices(),default:"none",onChange:e=>this.changeCompendium(e)}]]}static getCompendiumnsChoices(){const e=game;var t={none:"None"};return e.packs.forEach(e=>{t[e.metadata.name]=e.metadata.label}),t}changeCompendium(e){s.default.Ok("The item compendium to use is: "+e)}static Get(){return l.instance||(l.instance=new l,l.instance)}RegisterSettings(){if(!this.SettingsInit){(0,a.Assert)(game instanceof Game);const t=game;this.SettingsList.forEach(e=>{t.settings.register(a.default.ModuleName,e[0],e[1])}),this.SettingsInit=!0}}}t.default=l},{"../Globals":1,"./Logger":3}],5:[function(r,e,t){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r("./Utils/Logger")),o=n(r("./Utils/MerchantSettings"));t=n(r("./merchant/MerchantSheet"));const a=n(r("./PreloadTemplates")),s=n(r("./merchant/MerchantSheetNPCHelper"));Hooks.once("init",async()=>{await(0,a.default)()}),Hooks.once("setup",()=>{const e=r("csv-parse/lib/sync");var t=e("type,part\r\nunicorn,horn\r\nrainbow,pink",{columns:!1,autoParse:!0,skip_empty_lines:!0});console.log(t),socket.on("module.merchantsheetnpc",e=>{game.user.isGM&&(s.default.updateActorWithPacket(e),console.log("test",e))}),i.default.Log("Template module is being setup.")}),Hooks.once("ready",()=>{o.default.Get().RegisterSettings(),i.default.Ok("Template module is now ready.")}),Actors.registerSheet("core",t.default,{label:"merchant NPC",types:["npc"],makeDefault:!1})},{"./PreloadTemplates":2,"./Utils/Logger":3,"./Utils/MerchantSettings":4,"./merchant/MerchantSheet":6,"./merchant/MerchantSheetNPCHelper":7,"csv-parse/lib/sync":31}],6:[function(e,i,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=r(e("../Globals")),u=r(e("../Utils/Logger")),c=r(e("./MerchantSheetNPCHelper")),o=r(e("../Utils/MerchantSettings")),a=r(e("./model/QuantityChanger"));let b,f=new c.default;const v=e("csv-parse/lib/sync");class s extends ActorSheet{get template(){b=f.systemCurrencyCalculator();let e=game;return Handlebars.registerHelper("equals",function(e,t,r){return e==t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("inputStyle",function(e){return b.inputStyle()}),Handlebars.registerHelper("sectionStyle",function(e){return b.sectionStyle()}),Handlebars.registerHelper("editorStyle",function(e){return b.editorStyle()}),Handlebars.registerHelper("shouldItemBeVisible",function(e,t,r){return t||0<e}),Handlebars.registerHelper("getItemQuantity",function(e,t){return b.getQuantity(e)}),Handlebars.registerHelper("getItemWeight",function(e,t){return b.getWeight(e)}),Handlebars.registerHelper("getPriceCurrency",function(){return b.currency()}),Handlebars.registerHelper("unequals",function(e,t,r){return e!=t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("isPermissionShown",function(){return b.isPermissionShown()}),Handlebars.registerHelper("itemSelected",function(e){var t=game.settings.get(l.default.ModuleName,"itemCompendium");return console.log(e," - ",t),e===t?"selected":""}),Handlebars.registerHelper("getTypeLocalized",function(e){return game.i18n.localize("MERCHANTNPC."+e)}),Handlebars.registerHelper("merchantsheetprice",function(e,t){return"undefined"===t&&(this.actor.setFlag(l.default.ModuleName,"priceModifier",1),t=1),b.getPriceOutputWithModifier(e,t)}),Handlebars.registerHelper("merchantsheetstackweight",function(t,r,n){if(e.settings.get(l.default.ModuleName,"showStackWeight")){let e=t*r;return r===Number.MAX_VALUE||1e9<e||n?"/-":"/"+e.toLocaleString("en")}return""}),Handlebars.registerHelper("merchantsheetweight",function(e){return(Math.round(1e5*e)/1e5).toString()}),Handlebars.registerHelper("itemInfinity",function(e,t){return t||e===Number.MAX_VALUE}),n()}static get defaultOptions(){var e=super.defaultOptions;return mergeObject(e,{classes:["sheet actor npc npc-sheet merchant-sheet-npc wfrp4e"],width:890,height:750}),e}getData(e){var t,r,n,i;const o=super.getData();if(d(o.actor))return b=f.systemCurrencyCalculator(),n=game,t=this.prepareGMSettings(o.actor),null!==(n=n.user)&&void 0!==n&&n.isGM?o.isGM=!0:o.isGM=!1,o.isPermissionShown=o.isGM&&b.isPermissionShown(),n=1,r="merchantsheetnpc",n=this.actor.getFlag(r,"priceModifier"),o.infinity=this.actor.getFlag(r,"infinity"),o.isService=this.actor.getFlag(r,"service"),i=20,i=this.actor.getFlag(r,"stackModifier"),o.totalItems=this.actor.data.items.size,o.priceModifier=n,o.stackModifier=i,o.sections=b.prepareItems(this.actor.itemTypes),o.merchant=t,o.owner=o.isGM,o}prepareGMSettings(e){let t=game;const r=[],n=[];var i,o=null===(o=t.users)||void 0===o?void 0:o.players;let a=-1;if(void 0===o)return{};for(i of o)if(void 0!==i){let e=i;var s=t.actors.get(e.data.character);s&&(e.actor=s.data.name,e.actorId=s.data._id,e.playerId=e.data._id,e.merchantPermission=f.getMerchantPermissionForPlayer(this.actor.data,e),2<=e.merchantPermission&&!n.includes(s.data._id)&&n.push(s.data._id),a<0?a=e.merchantPermission:a!==e.merchantPermission&&(a=999),e.icon=f.getPermissionIcon(e.merchantPermission),e.merchantPermissionDescription=f.getPermissionDescription(e.merchantPermission),r.push(e))}return{players:r,observerCount:n.length,playersPermission:a,playersPermissionIcon:f.getPermissionIcon(a),playersPermissionDescription:f.getPermissionDescription(a)}}async _onDropItemCreate(e){return b.onDropItemCreate(e,this)}async callSuperOnDropItemCreate(e){return super._onDropItemCreate(e)}onItemCreate(e){e.preventDefault();e=e.currentTarget;console.log(e),console.log(e.dataset);const t=e.dataset.type,r={name:game.i18n.format("MERCHANTNPC.item-new",{type:game.i18n.localize("MERCHANTNPC."+t.toLowerCase())}),type:t,data:foundry.utils.deepClone(e.dataset)};return delete r.data.type,this.actor.createEmbeddedDocuments("Item",[r])}onItemEdit(e){e.preventDefault();e=$(e.currentTarget).parents(".merchant-item").attr("data-item-id");const t=this.actor.items.get(e);return t.sheet.render(!0)}activateListeners(e){super.activateListeners(e),e.find(".permission-proficiency").on("click",e=>this.onCyclePermissionProficiency(e)),e.find(".permission-proficiency-bulk").on("click",e=>this.onCyclePermissionProficiencyBulk(e)),e.find(".price-modifier").on("click",e=>this.buyFromMerchantModifier(e)),e.find(".buy-modifier").on("click",e=>this.sellToMerchantModifier(e)),e.find(".stack-modifier").on("click",e=>this.stackModifier(e)),e.find(".csv-import").on("click",e=>this.csvImport(e)),e.find(".change-quantity-all").on("click",e=>this.changeQuantityForItems(e)),e.find(".merchant-settings").on("click",e=>this.merchantSettingChange(e)),e.find(".item-buy").on("click",e=>this.buyItem(e)),e.find(".item-buystack").on("click",e=>this.buyItem(e,1)),e.find(".item-delete").on("click",e=>f.deleteItem(e,this.actor)),e.find(".change-item-quantity").on("click",e=>f.changeQuantity(e,this.actor)),e.find(".change-item-price").on("click",e=>f.changePrice(e,this.actor)),e.find(".merchant-item .item-name").on("click",e=>f.onItemSummary(e,this.actor)),e.find(".item-add").on("click",this.onItemCreate.bind(this)),e.find(".item-edit").on("click",this.onItemEdit.bind(this))}async merchantSettingChange(e){e.preventDefault();var e="modules/"+l.default.ModuleName+"/templates/settings.html",t=(u.default.Log("infinity: ",this.actor.getFlag(l.default.ModuleName,"infinity"),this.actor),{disableSell:this.actor.getFlag(l.default.ModuleName,"disableSell")?"checked":"",keepDepleted:this.actor.getFlag(l.default.ModuleName,"keepDepleted")?"checked":"",service:this.actor.getFlag(l.default.ModuleName,"service")?"checked":""}),e=await renderTemplate(e,t);let r=new Dialog({title:game.i18n.localize("MERCHANTNPC.settings"),content:e,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.update"),callback:()=>{this.actor.setFlag(l.default.ModuleName,"disableSell",c.default.getElementById("disable-sell").checked),this.actor.setFlag(l.default.ModuleName,"keepDepleted",c.default.getElementById("keep-depleted").checked),this.actor.setFlag(l.default.ModuleName,"service",c.default.getElementById("service").checked)}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>console.log("Merchant sheet | Stack Modifier Cancelled")}},default:"two",close:()=>console.log("Merchant sheet | Stack Modifier Closed")});r.render(!0)}onCyclePermissionProficiency(e){e.preventDefault();var t=this.actor,r=$(e.currentTarget).siblings('input[type="hidden"]'),n=this.getNewLevel(r),r=r[0].name;f.updatePermissions(t,r,n,e),this._onSubmit(e)}onCyclePermissionProficiencyBulk(e){e.preventDefault();var t=this.actor.data,r=$(e.currentTarget).parent().siblings('input[type="hidden"]'),n=this.getNewLevel(r),r=null===(r=game.users)||void 0===r?void 0:r.contents;let i=duplicate(t.permission);if(void 0!==r){for(var o of r)1!==o.data.role&&2!==o.data.role||(i[o.data._id]=n);const a=new PermissionControl(this.actor);a._updateObject(e,i),this._onSubmit(e)}}getNewLevel(e){let t=0;e=e.val();"string"==typeof e&&(t=parseFloat(e));const r=[0,2];e=r.indexOf(t);return r[e===r.length-1?0:e+1]}async buyFromMerchantModifier(e){e.preventDefault();let t=await this.actor.getFlag(l.default.ModuleName,"priceModifier");"undefined"===t&&(t=1),t=Math.round(100*t);var e="modules/"+l.default.ModuleName+"/templates/buy_from_merchant.html",r={priceModifier:t},e=await renderTemplate(e,r);let n=new Dialog({title:game.i18n.localize("MERCHANTNPC.buyMerchantDialog-title"),content:e,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.update"),callback:()=>{var e=document.getElementById("price-modifier-percent").value;0===e?this.actor.setFlag(l.default.ModuleName,"priceModifier",0):this.actor.setFlag(l.default.ModuleName,"priceModifier",e/100)}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>u.default.Log("Price Modifier Cancelled")}},default:"two",close:()=>u.default.Log("Price Modifier Closed")});n.render(!0)}async sellToMerchantModifier(e){e.preventDefault();let t=await this.actor.getFlag("merchantsheetnpc","buyModifier");"undefined"===t&&(t=.5),t=Math.round(100*t);var e="modules/"+l.default.ModuleName+"/templates/sell_to_merchant.html",r={buyModifier:t},e=await renderTemplate(e,r);let n=new Dialog({title:game.i18n.localize("MERCHANTNPC.sellToMerchantDialog-title"),content:e,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.update"),callback:()=>{var e=document.getElementById("price-modifier-percent").value;0===e?this.actor.setFlag(l.default.ModuleName,"buyModifier",0):this.actor.setFlag(l.default.ModuleName,"buyModifier",e/100)}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>console.log("Merchant sheet | Buy Modifier Cancelled")}},default:"two",close:()=>console.log("Merchant sheet | Buy Modifier Closed")});n.render(!0)}async stackModifier(e){e.preventDefault();let t=await this.actor.getFlag(l.default.ModuleName,"stackModifier");t=t||20;var e="modules/"+l.default.ModuleName+"/templates/stack_modifier.html",r={stackModifier:t},e=await renderTemplate(e,r);let n=new Dialog({title:game.i18n.localize("MERCHANTNPC.stack-modifier"),content:e,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.update"),callback:()=>{var e=c.default.getElementById("stack-modifier").value;this.actor.setFlag(l.default.ModuleName,"stackModifier",parseInt(e))}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>console.log("Merchant sheet | Stack Modifier Cancelled")}},default:"two",close:()=>console.log("Merchant sheet | Stack Modifier Closed")});n.render(!0)}async csvImport(e){e.preventDefault();var e="modules/"+l.default.ModuleName+"/templates/csv-import.html",t={itemTypes:game.system.documentTypes.Item,compendiums:o.default.getCompendiumnsChoices()},e=await renderTemplate(e,t);let r=new Dialog({title:game.i18n.localize("MERCHANTNPC.csv-import"),content:e,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.update"),callback:()=>{var e=document.getElementById("csv-pack-name").value,t=document.getElementById("csv-item-name").value,r=document.getElementById("csv-type-name").value,n=document.getElementById("csv-scroll-name-value").value,i=document.getElementById("csv-price-value").value,o=document.getElementById("csv-name-value").value,a=document.getElementById("csv-skip-value").checked,s=document.getElementById("csv").value;this.createItemsFromCSV(this.actor,{pack:e,itemPack:t,scrollStart:n,priceCol:i,nameCol:o,skip:a,input:s,type:r})}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>console.log("Merchant sheet | Stack Modifier Cancelled")}},default:"two",close:()=>console.log("Merchant sheet | Stack Modifier Closed")});r.render(!0)}async createItemsFromCSV(i,o){var a;let e=1;o.skip&&e++;var t=v(o.input,{columns:!1,autoParse:!0,skip_empty_lines:!0,from_line:e});let s=await this.findSpellPack(o.itemPack),l=await this.findSpellPack(o.pack);var u,h,p=Number(o.nameCol)-1;let c=-1;void 0!==o.priceCol&&(c=Number(o.priceCol)-1),console.log("Merchant sheet | csvItems",t);for(u of t){let t=0;if(0<u.length&&0<u[p].length){let r=u[p].trim(),n=(0<=c&&(t=u[c]),[]);if(r.startsWith(o.scrollStart)&&void 0!==l){let t=r.substr(o.scrollStart.length,r.length).trim();for(const g of await l.index.filter(e=>e.name===t)){var f=await l.getDocument(g._id),f=await b.createScroll(f.data);void 0!==f&&n.push(f)}}else{let e=[];if(void 0!==s){e=s.index.filter(e=>e.name===r);for(const y of e){var m=await s.getDocument(y._id);n.push(duplicate(m))}}0===e.length&&this.crateNewItem(r,t,o.type,n)}for(var d of n)0<t&&(void 0===(null===(a=null===d||void 0===d?void 0:d.data)||void 0===a?void 0:a.price)||0===(null===(a=null===d||void 0===d?void 0:d.data)||void 0===a?void 0:a.price))&&d.update({[b.getPriceItemKey()]:t});let e=await i.items.find(e=>e.data.name==r);void 0===e?(console.log("Create item on actor: ",n),await i.createEmbeddedDocuments("Item",n)):(h=b.getQuantity(e.data.data.quantity)+Number(1),await e.update({"data.quantity":h}))}}await this.collapseInventory(i)}crateNewItem(e,t,r,n){const i={name:e,type:r,data:foundry.utils.deepClone({type:"consumable",price:t})};delete i.data.type,n.push(i)}async findSpellPack(t){if("none"!==t)return(await game.packs.filter(e=>e.metadata.name===t))[0]}async collapseInventory(e){i=e.items,r="name";var r,t,n,i=i.reduce(function(e,t){return(e[t[r]]=e[t[r]]||[]).push(t),e},{});let o=[];for([t,n]of Object.entries(i)){var a,s,l=n[0];for(a of n)l!==a&&(s=b.getQuantity(l.data.data.quantity)+b.getQuantity(a.data.data.quantity),await l.update({"data.quantity":s}),o.push(a.id))}await e.deleteEmbeddedDocuments("Item",o)}buyItem(e,t=0){e.preventDefault(),console.log("Merchant sheet | Buy Item clicked");let r=null;null!==(n=game.users)&&void 0!==n&&n.forEach(e=>{var t;e.isGM&&e.active&&e.viewedScene===(null===(t=game.user)||void 0===t?void 0:t.viewedScene)&&(r=e)});var n=game.settings.get("merchantsheetnpc","allowNoGM");let i=null;if(!n&&!r)return u.default.Log("No Valid GM",n),ui.notifications.error(game.i18n.localize("MERCHANTNPC.error-noGM"));if(n||(i=r.data._id),null===this.token)return ui.notifications.error(game.i18n.localize("MERCHANTNPC.error-noToken"));if(!game.user.actorId)return ui.notifications.error(game.i18n.localize("MERCHANTNPC.error-noCharacter"));var n=$(e.currentTarget).parents(".merchant-item").attr("data-item-id"),o=$(e.currentTarget).parents(".merchant-item").attr("data-item-stack"),a=this.actor.getEmbeddedDocument("Item",n);if(b.getQuantity(a.data.data.quantity)<=0)return(ui.notifications||new Notifications).error(game.i18n.localize("MERCHANTNPC.invalidQuantity"));const s={type:"buy",buyerId:game.user.actorId,tokenId:this.token.id,itemId:n,quantity:1,processorId:i};n=this.token.actor.getFlag(l.default.ModuleName,"service");if(t||e.shiftKey)b.getQuantity(a.data.data.quantity)<o?s.quantity=b.getQuantity(a.data.data.quantity):s.quantity=o,c.default.buyTransactionFromPlayer(s);else if(n)s.quantity=1,c.default.buyTransactionFromPlayer(s);else{let e=new h(e=>{s.quantity=e,c.default.buyTransactionFromPlayer(s)},{acceptLabel:"Purchase"});e.render(!0)}}async changeQuantityForItems(e){e.preventDefault();var e="modules/"+l.default.ModuleName+"/templates/change_all_quantity.html",t={infinity:this.actor.getFlag(l.default.ModuleName,"infinity")?"checked":""},e=await renderTemplate(e,t);let r=new Dialog({title:game.i18n.localize("MERCHANTNPC.quantity"),content:e,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.update"),callback:()=>{var e=new a.default(c.default.getElementById("quantity-infinity").checked,c.default.getElementById("quantity-value").value);this.updateQuantityForAllItems(this.actor,e)}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>console.log("Merchant sheet | Stack Modifier Cancelled")}},default:"two",close:()=>console.log("Merchant sheet | Stack Modifier Closed")});r.render(!0)}updateQuantityForAllItems(t,e){if(t.setFlag(l.default.ModuleName,"infinity",e.infinity),!e.infinity){let i=c.default.getElementById("quantity-value").value;if(i&&!/^\s*$/.test(i)){let e=t.items,n=[];e.forEach(e=>{let t=new Roll(i);var e=e.id,r=t.roll({async:!1}).total;n.push({_id:e,[b.getQuantityKey()]:r})}),t.updateEmbeddedDocuments("Item",n)}}}}class h extends Dialog{constructor(t,e){"object"!=typeof e&&(e={});let r=!1;super({title:game.i18n.localize("MERCHANTNPC.quantity"),content:`
            <form>
                <div class="form-group">
                    <label>`+game.i18n.localize("MERCHANTNPC.quantity")+`:</label>
                    <input style="`+b.inputStyle()+`" type=number min="1" id="quantity" name="quantity" value="1">
                </div>
            </form>`,buttons:{yes:{icon:"<i class='fas fa-check'></i>",label:e.acceptLabel||game.i18n.localize("MERCHANTNPC.item-buy"),callback:()=>r=!0},no:{icon:"<i class='fas fa-times'></i>",label:game.i18n.localize("MERCHANTNPC.cancel")}},default:"yes",close:()=>{if(r){var e=document.getElementById("quantity").value;if(isNaN(e))return ui.notifications.error(game.i18n.localize("MERCHANTNPC.error-quantityInvalid"));t(e)}}})}}(class extends Dialog{});function n(){return"./modules/"+l.default.ModuleName+"/templates/npc-sheet.html"}function d(e){return(null===(e=e._sheet)||void 0===e?void 0:e.template)===n()}function p(e){d(e)&&f.initModifiers(e)}Hooks.on("updateActor",async function(e,t,r){p(e)}),Hooks.on("createActor",async function(e,t,r){p(e)}),Hooks.on("dropActorSheetData",async function(i,e,o,t){var a=i.getFlag(l.default.ModuleName,"disableSell");if(void 0!==a&&a)return!1;if("Item"==o.type&&o.actorId)if(i.data._id){if(b.getQuantity(o.data.data.quantity)<=0)(ui.notifications||new Notifications).error(game.i18n.localize("MERCHANTNPC.invalidQuantity"));else if(i.data._id!=o.actorId){let n=null===(a=game.actors)||void 0===a?void 0:a.get(o.actorId);if(u.default.Log("Drop item",o,i),void 0!==n&&d(i)){let r=n,e=(console.log(i),i.getFlag(l.default.ModuleName,"buyModifier"));e,0;var a=b.getPriceFromItem(o.data),s=b.priceInText(e*a),s="<div>"+game.i18n.format("MERCHANTNPC.sell-items-player",{name:o.data.name,price:s})+"</div>",s=(s=(s+='<div><input name="quantity-modifier" id="quantity-modifier" type="range" min="0" max="'+b.getQuantity(o.data.data.quantity)+'" value="1" class="slider"></div>')+("<div><label>"+game.i18n.localize("MERCHANTNPC.quantity")+':</label> <input style="'+b.inputStyle()+'" type=number min="0" max="'+b.getQuantity(o.data.data.quantity)+'" value="1" id="quantity-modifier-display"></div> <input type="hidden" id="quantity-modifier-price" value = "'+e*a+'"/>')+'<script>var pmSlider = document.getElementById("quantity-modifier"); var pmDisplay = document.getElementById("quantity-modifier-display"); var total = document.getElementById("quantity-modifier-total"); var price = document.getElementById("quantity-modifier-price"); pmDisplay.value = pmSlider.value; pmSlider.oninput = function() { pmDisplay.value = this.value;  total.value =this.value * price.value; }; pmDisplay.oninput = function() { pmSlider.value = this.value; };<\/script>')+("<div>"+game.i18n.localize("MERCHANTNPC.total")+'<input style="'+b.inputStyle()+'" readonly type="text"  value="'+a*e+'" id = "quantity-modifier-total"/> </div>');let t=new Dialog({title:game.i18n.localize("MERCHANTNPC.sell-item"),content:s,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.sell"),callback:()=>{var e=document.getElementById("quantity-modifier").value,t=o.data._id,t=(f.moveItems(r,i,[{itemId:t,quantity:e}],!0),document.getElementById("quantity-modifier-total").value);f.sellItem(i,o,n,e,t)}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>console.log("Merchant sheet | Price Modifier Cancelled")}},default:"two",close:()=>console.log("Merchant sheet | Price Modifier Closed")});t.render(!0)}}}else console.warn("Merchant sheet | target has no data._id?",i)}),t.default=s},{"../Globals":1,"../Utils/Logger":3,"../Utils/MerchantSettings":4,"./MerchantSheetNPCHelper":7,"./model/QuantityChanger":9,"csv-parse/lib/sync":31}],7:[function(e,o,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const m=r(e("../Globals")),n=r(e("./systems/CurrencyCalculator")),a=r(e("./systems/Dnd5eCurrencyCalculator")),s=r(e("./systems/World5eCurrencyCalculator")),l=r(e("./systems/SfrpgCurrencyCalculator")),u=r(e("./systems/SwadeCurrencyCalculator")),g=r(e("../Utils/Logger")),f=r(e("./systems/Wfrp4eCurrencyCalculator")),y=r(e("./model/MoveItemsPacket"));let b;class i{static getElementById(e){return document.getElementById(e)}systemCurrencyCalculator(){var e,t;return null!==b&&void 0!==b||(t=game.system.id.charAt(0).toUpperCase()+game.system.id.slice(1)+"CurrencyCalculator",g.default.Log("System currency to get: "+t),null!==(e=game.modules.get("world-currency-5e"))&&void 0!==e&&e.active?b=new s.default:"Dnd5eCurrencyCalculator"==t?b=new a.default:"SfrpgCurrencyCalculator"==t?(b=new l.default,g.default.Log("Getting star finder",b)):b=new("SwadeCurrencyCalculator"==t?u:"Wfrp4eCurrencyCalculator"==t?f:n).default,b.initSettings()),b}getMerchantPermissionForPlayer(e,t){var r=e.permission.default;return null===t.data._id?0:t.data._id in e.permission?e.permission[t.data._id]:void 0!==r?r:0}getPermissionIcon(e){return{0:'<i class="far fa-circle"></i>',2:'<i class="fas fa-eye"></i>',999:'<i class="fas fa-users"></i>'}[e]}getPermissionDescription(e){return{0:game.i18n.localize("MERCHANTNPC.permission-none-help"),2:game.i18n.localize("MERCHANTNPC.permission-observer-help"),999:game.i18n.localize("MERCHANTNPC.permission-all-help")}[e]}updatePermissions(e,t,r,n){console.log("Merchant sheet | _updatePermission ",e,t,r,n);let i=duplicate(e.data.permission);i[t]=r,console.log("Merchant sheet | _updatePermission ",i,e.data.permission);const o=new PermissionControl(e.data);console.log("Merchant sheet | _updatePermission merchantPermissions",o),o._updateObject(n,i)}async changePrice(e,t){e.preventDefault(),console.log("Merchant sheet | Change item price");e=$(e.currentTarget).parents(".merchant-item").attr("data-item-id");const r=t.getEmbeddedDocument("Item",e);t="modules/"+m.default.ModuleName+"/templates/change_price.html",e={price:b.getPriceFromItem(r.data)},t=await renderTemplate(t,e);let n=new Dialog({title:game.i18n.localize("MERCHANTNPC.priceDialog-title"),content:t,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.update"),callback:()=>{r.update({[b.getPriceItemKey()]:b.getPrice(document.getElementById("price-value").value)})}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>console.log("Merchant sheet | Change price Cancelled")}},default:"two",close:()=>console.log("Merchant sheet | Change price Closed")});n.render(!0)}deleteItem(e,t){e.preventDefault(),console.log("Merchant sheet | Delete Item clicked"),e=$(e.currentTarget).parents(".merchant-item").attr("data-item-id"),t.deleteEmbeddedDocuments("Item",[e])}onItemSummary(e,t){e.preventDefault();let r=$(e.currentTarget).parents(".merchant-item"),n=t.items.get(r.data("item-id")),i=n.getChatData({secrets:t.isOwner});if(r.hasClass("expanded")){let e=r.children(".merchant-item-summary");e.slideUp(200,()=>e.remove())}else{let e=$(`<div class="merchant-item-summary">${b.getDescription(i.description)}</div>`);r.append(e.hide()),e.slideDown(200)}r.toggleClass("expanded")}async changeQuantity(e,t){e.preventDefault(),console.log("Merchant sheet | Change quantity");let r=$(e.currentTarget).parents(".merchant-item").attr("data-item-id");var e=t.getEmbeddedDocument("Item",r),n="modules/"+m.default.ModuleName+"/templates/change_quantity.html",e=b.getQuantity(e.data.data.quantity),i=e===Number.MAX_VALUE?"checked":"",n=await renderTemplate(n,{quantity:e,infinity:i});let o=new Dialog({title:game.i18n.localize("MERCHANTNPC.quantityDialog-title"),content:n,buttons:{one:{icon:'<i class="fas fa-check"></i>',label:game.i18n.localize("MERCHANTNPC.update"),callback:()=>{var e;document.getElementById("quantity-infinity").checked?t.updateEmbeddedDocuments("Item",[{_id:r,[b.getQuantityKey()]:Number.MAX_VALUE}]):(e=document.getElementById("quantity-value").value,t.updateEmbeddedDocuments("Item",[{_id:r,[b.getQuantityKey()]:e}]))}},two:{icon:'<i class="fas fa-times"></i>',label:game.i18n.localize("MERCHANTNPC.cancel"),callback:()=>console.log("Merchant sheet | Change quantity Cancelled")}},default:"two",close:()=>console.log("Merchant sheet | Change quantity Closed")});o.render(!0)}async sellItem(e,t,r,n,i){var o=b.actorCurrency(r),a=b.priceInText(i);b.addAmountForActor(r,o,i),this.chatMessage(r,e,game.i18n.format("MERCHANTNPC.sellText",{seller:r.name,quantity:n,itemName:t.data.name,chatPrice:a}),t.data,!1)}async transaction(t,r,n,i){console.log(`Buying item: ${t}, ${r}, ${n}, `+i);var o=t.getEmbeddedDocument("Item",n);if((i=void 0!==o&&o.data.data.quantity<i?b.getQuantity(o.data.data.quantity):i)<0)this.errorMessageToActor(r,game.i18n.localize("MERCHANTNPC.error-negativeAmountItems"));else if(0!=i){let e=t.getFlag(m.default.ModuleName,"priceModifier");var a=t.getFlag(m.default.ModuleName,"stackModifier"),a=("undefined"===e&&(e=1),void 0!==a&&a<i&&(i=a),Math.round(b.getPriceFromItem(o.data)*e*100)/100),s=(a*=i,b.actorCurrency(r)),s=duplicate(s);if(b.buyerHaveNotEnoughFunds(a,s))this.errorMessageToActor(r,game.i18n.localize("MERCHANTNPC.error-noFunds"));else{b.subtractAmountFromActor(r,s,a);var l=b.priceInText(a),s=t.getFlag(m.default.ModuleName,"service");if(s)this.chatMessage(t,r,game.i18n.format("MERCHANTNPC.buyText",{buyer:r.name,quantity:i,itemName:o.name,chatPrice:l}),o,s);else{var u,a=t.getFlag(m.default.ModuleName,"keepDepleted"),o=(g.default.Log("keepDepleted",a),await c.moveItems(t,r,[{itemId:n,quantity:i}],!a));for(u of o)this.chatMessage(t,r,game.i18n.format("MERCHANTNPC.buyText",{buyer:r.name,quantity:i,itemName:u.item.name,chatPrice:l}),u.item,!1)}}}}chatMessage(e,t,r,n,i){game.settings.get(m.default.ModuleName,"buyChat")&&(r=`
            <div class="chat-card item-card" data-actor-id="${t.id}" data-item-id="${n.id}">
                <header class="card-header flexrow">
            		<div class= "merchant-item-image" style="background-image: url(${n.img})"></div>
                    <h3 class="item-name">${n.name}</h3>
                </header>

                <div class="message-content">
                    <p>`+r+`</p>
                </div>
            </div>
            `,ChatMessage.create({user:game.user.id,speaker:{actor:e,alias:e.name},content:r}))}errorMessageToActor(e,t){var r;null!==(r=ui.notifications)&&void 0!==r&&r.error(t)}static buyTransactionFromPlayer(e){var t,r;console.log("Merchant sheet | buyTransaction ",e),"buy"===e.type&&(t=game.actors.get(e.buyerId),r=canvas.tokens.get(e.tokenId),t&&r&&r.actor?c.transaction(r.actor,t,e.itemId,e.quantity):r||null!==(t=ui.notifications)&&void 0!==t&&t.error(game.i18n.localize("MERCHANTNPC.playerOtherScene")))}async moveItems(r,n,e,c){const i=[],o=[],a=[],s=[],f=[];var d,h=game.settings.get(m.default.ModuleName,"allowNoGM");for(d of e){var l=d.itemId;let e=Number(d.quantity);var u=r.getEmbeddedDocument("Item",l),p=r.getFlag(m.default.ModuleName,"infinity");void 0!==u&&b.getQuantity(u.data.data.quantity)<e&&(e=Number(b.getQuantity(u.data.data.quantity)));let t=duplicate(u);p={_id:l,[b.getQuantityKey()]:b.getQuantity(u.data.data.quantity)>=Number.MAX_VALUE-1e4||p?Number.MAX_VALUE:b.getQuantity(u.data.data.quantity)-e},u=(0===p[b.getQuantityKey()]&&!h&&c?o.push(l):i.push(p),b.setQuantityForItemData(t.data,e),f.push({item:t,quantity:e}),n.data.items.find(e=>e.name==t.name));void 0===u?a.push(t):(b.setQuantityForItemData(u.data.data,Number(b.getQuantity(u.data.data.quantity))+Number(b.getQuantity(t.data.quantity))),b.getQuantity(u.data.data.quantity)<0&&b.setQuantityForItemData(u.data.data,0),l={_id:u.id,[b.getQuantityKey()]:b.getQuantity(u.data.data.quantity)},s.push(l))}let t=null;return r.isOwner?(0<o.length&&await r.deleteEmbeddedDocuments("Item",o),0<i.length&&await r.updateEmbeddedDocuments("Item",i)):h||(t=new y.default,r.id&&(t.actorId=r.id),t.deletes=o,t.updates=i,r.data.actorLink||r.parent&&(e=canvas.scene.id,g.default.Log("Scene",canvas.scene.id),e&&(t.sceneId=e),t.tokenId=r.parent.id,t.actorLink=!1)),n.isOwner?(0<a.length&&await n.createEmbeddedDocuments("Item",a),0<s.length&&await n.updateEmbeddedDocuments("Item",s)):h||(t=new y.default,n.id&&(t.actorId=n.id),t.additions=a,t.updates=s),t&&game.socket.emit(m.default.Socket,t),f}initModifiers(e){var t=e.getFlag(m.default.ModuleName,"priceModifier"),r=e.getFlag(m.default.ModuleName,"buyModifier"),n=e.getFlag(m.default.ModuleName,"stackModifier");void 0===t&&e.setFlag(m.default.ModuleName,"priceModifier",1),void 0===r&&e.setFlag(m.default.ModuleName,"buyModifier",.5),void 0===n&&e.setFlag(m.default.ModuleName,"stackModifier",20),e.render()}static async updateActorWithPacket(r){let n=null;if(r.actorLink)n=await game.actors.get(r.actorId);else{let e=await game.scenes.get(r.sceneId),t=(g.default.Log("Scene found",e),await e.tokens.get(r.tokenId));t.getActor()&&(n=t.getActor())}n&&(g.default.Log("Actor updating",n),0<r.deletes.length&&(await n.deleteEmbeddedDocuments("Item",r.deletes),g.default.Log("delete Items ",r.deletes)),0<r.updates.length&&(g.default.Log("delete Items ",r.updates),await n.updateEmbeddedDocuments("Item",r.updates)),0<r.additions.length&&(g.default.Log("delete Items ",r.additions),await n.createEmbeddedDocuments("Item",r.additions)))}}let c=new i;t.default=i},{"../Globals":1,"../Utils/Logger":3,"./model/MoveItemsPacket":8,"./systems/CurrencyCalculator":10,"./systems/Dnd5eCurrencyCalculator":11,"./systems/SfrpgCurrencyCalculator":12,"./systems/SwadeCurrencyCalculator":13,"./systems/Wfrp4eCurrencyCalculator":14,"./systems/World5eCurrencyCalculator":15}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=class{constructor(){this.updates=[],this.deletes=[],this.additions=[],this.actorId="",this.sceneId="",this.actorLink=!0,this.tokenId=null}}},{}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=class{constructor(e,t){this.infinity=!1,this.value="",this.infinity=e,this.value=t}}},{}],10:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});const i=n(e("../../Utils/Logger"));r.default=class{constructor(){this.initialized=!1}actorCurrency(e){return e.data.data.currency}buyerHaveNotEnoughFunds(e,t){return t<e}subtractAmountFromActor(e,t,r){this.updateActorWithNewFunds(e,t-=r),console.log("Merchant Sheet | Funds after purchase: "+t)}addAmountForActor(e,t,r){this.updateActorWithNewFunds(e,t=+t+ +r),console.log("Merchant Sheet | Funds after sell: "+t)}updateActorWithNewFunds(e,t){e.update({"data.currency":t})}priceInText(e){return e.toString()}initSettings(){this.initialized=!0}prepareItems(e){return console.log("Merchant Sheet | Prepare basic Features"),{weapons:{label:"All",items:e,type:"all"}}}async onDropItemCreate(e,t){return t.callSuperOnDropItemCreate(e)}async createScroll(e){return e}getPriceFromItem(e){return e.data.price}getPriceItemKey(){return"data.price"}getDescription(e){return e.value}getQuantity(e){return e}getQuantityKey(){return"data.quantity"}getWeight(e){return e.weight}getPriceOutputWithModifier(e,t){return(Math.round(e*t*100)/100).toLocaleString("en")}getPrice(e){return e}currency(){return""}setQuantityForItemData(e,t){i.default.Log("Changing quantity for item and set quantity",e,t),e.quantity=t}inputStyle(){return""}editorStyle(){return""}isPermissionShown(){return!0}sectionStyle(){return""}}},{"../../Utils/Logger":3}],11:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(r,"__esModule",{value:!0}),n(e("./CurrencyCalculator")));const h=n(e("../../Globals"));let p={pp:1,gp:1,ep:1,sp:1,cp:1};const m={pp:"gp",gp:"ep",ep:"sp",sp:"cp"};class o extends i.default{async onDropItemCreate(e,t){var r;return"spell"===e.type?(r=await this.createScroll(e),t.callSuperOnDropItemCreate(r)):t.callSuperOnDropItemCreate(e)}async createScrollFromSpell(e){var t=e,r=e.data.level,e=e.data.description,n=`Compendium.${CONFIG.DND5E.sourcePacks.ITEMS}.`+CONFIG.DND5E.spellScrollIds[r];const i=await fromUuid(n),o=i.toObject(),a=(delete o._id,o.data.description.value);var n="</p>",s=a.indexOf(n),l=a.slice(0,s+n.length),s=a.slice(s+n.length);const c=`${l}<hr/><h3>${t.name} (Level ${r})</h3><hr/>${e.value}<hr/><h3>Scroll Details</h3><hr/>`+s;let u=duplicate(t);return u.name=game.i18n.localize("DND5E.SpellScroll")+": "+t.name,u.img=o.img,u.type="consumable",u.data.description.value=c.trim(),u}async createScroll(e){return this.createScrollFromSpell(e)}actorCurrency(e){return e.data.data.currency}buyerHaveNotEnoughFunds(e,t){e/=p.gp;return this.convertToPlatinum(t)<e}convertToPlatinum(e){var t=e.pp;return(t+=e.gp/p.gp)+e.ep/p.gp/p.ep+e.sp/p.gp/p.ep/p.sp+e.cp/p.gp/p.ep/p.sp/p.cp}updateActorWithNewFunds(e,t){e.update({"data.currency":t})}subtractAmountFromActor(c,e,t){var r,t=t/p.gp,n=this.convertToPlatinum(e),f=(console.log("buyerFundsAsPlatinum : "+n),game.settings.get(h.default.ModuleName,"convertCurrency"));if(f){for(var d in n-=t,e)e[d]=0;e.pp=n}else for(var i in e.pp-=t,e){var o,a=e[i];0<=a||("cp"!=i?(o=m[i],e[i]=0,e[o]+=a*p[o]):e.cp=0)}for(r in e){var s=e[r],l=Math.floor(Math.round(1e5*s)/1e5),u=(e[r]=l,m[r]);"cp"!=r&&(s=Math.round(1e5*(s-l))/1e5*p[u],e[u]+=s)}this.updateActorWithNewFunds(c,e),console.log("Merchant sheet | Funds after purchase: "+e)}addAmountForActor(c,e,t){var r,t=t/p.gp,n=this.convertToPlatinum(e),f=(console.log("buyerFundsAsPlatinum : "+n),game.settings.get(h.default.ModuleName,"convertCurrency"));if(f){for(var d in n+=t,e)e[d]=0;e.pp=n}else for(var i in e.pp+=t,e){var o,a=e[i];0<=a||("cp"!=i?(o=m[i],e[i]=0,e[o]+=a*p[o]):e.cp=0)}for(r in e){var s=e[r],l=Math.floor(Math.round(1e5*s)/1e5),u=(e[r]=l,m[r]);"cp"!=r&&(s=Math.round(1e5*(s-l))/1e5*p[u],e[u]+=s)}this.updateActorWithNewFunds(c,e),console.log("Merchant Sheet | Funds after sell: "+e)}priceInText(e){return e+" gp"}prepareItems(e){console.log("Merchant Sheet | Prepare Features");const t={weapons:{label:game.i18n.localize("MERCHANTNPC.weapons"),items:[],type:"weapon"},equipment:{label:game.i18n.localize("MERCHANTNPC.equipment"),items:[],type:"equipment"},consumables:{label:game.i18n.localize("MERCHANTNPC.consumables"),items:[],type:"consumable"},tools:{label:game.i18n.localize("MERCHANTNPC.tools"),items:[],type:"tool"},containers:{label:game.i18n.localize("MERCHANTNPC.containers"),items:[],type:"container"},loot:{label:game.i18n.localize("MERCHANTNPC.loot"),items:[],type:"loot"}};return t.weapons.items=e.weapon,t.weapons.items.sort(this.sort()),t.equipment.items=e.equipment,t.equipment.items.sort(this.sort()),t.consumables.items=e.consumable,t.consumables.items.sort(this.sort()),t.tools.items=e.tool,t.tools.items.sort(this.sort()),t.containers.items=e.backpack,t.containers.items.sort(this.sort()),t.loot.items=e.loot,t.loot.items.sort(this.sort()),t}sort(){return function(e,t){return e.name.localeCompare(t.name)}}initSettings(){game.settings.register(h.default.ModuleName,"convertCurrency",{name:"Convert currency after purchases?",hint:"If enabled, all currency will be converted to the highest denomination possible after a purchase. If disabled, currency will subtracted simply.",scope:"world",config:!0,default:!1,type:Boolean}),p={pp:1,gp:CONFIG.DND5E.currencies.gp.conversion.each,ep:CONFIG.DND5E.currencies.ep.conversion.each,sp:CONFIG.DND5E.currencies.sp.conversion.each,cp:CONFIG.DND5E.currencies.cp.conversion.each},super.initSettings()}getPriceFromItem(e){return e.data.price}getPriceItemKey(){return"data.price"}currency(){return"GP"}}r.default=o},{"../../Globals":1,"./CurrencyCalculator":10}],12:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(r,"__esModule",{value:!0}),n(e("./CurrencyCalculator")));class i extends n.default{actorCurrency(e){return e.data.data.currency.credit}updateActorWithNewFunds(e,t){e.update({"data.currency.credit":t})}prepareItems(e){console.log("Merchant Sheet | Prepare Features"),console.log(e);const t={ammunition:{label:game.i18n.localize("MERCHANTNPC.ammunition"),items:e.ammunition,type:"ammunition"},augmentation:{label:game.i18n.localize("MERCHANTNPC.augmentation"),items:e.augmentation,type:"augmentation"},consumable:{label:game.i18n.localize("MERCHANTNPC.consumable"),items:e.consumable,type:"consumable"},container:{label:game.i18n.localize("MERCHANTNPC.container"),items:e.container,type:"container"},equipment:{label:game.i18n.localize("MERCHANTNPC.equipment"),items:e.equipment,type:"equipment"},fusion:{label:game.i18n.localize("MERCHANTNPC.fusion"),items:e.fusion,type:"fusion"},goods:{label:game.i18n.localize("MERCHANTNPC.goods"),items:e.goods,type:"goods"},hybrid:{label:game.i18n.localize("MERCHANTNPC.hybrid"),items:e.hybrid,type:"hybrid"},magic:{label:game.i18n.localize("MERCHANTNPC.magic"),items:e.magic,type:"magic"},shield:{label:game.i18n.localize("MERCHANTNPC.shield"),items:e.shield,type:"shield"},spell:{label:game.i18n.localize("MERCHANTNPC.spell"),items:e.spell,type:"spell"},technological:{label:game.i18n.localize("MERCHANTNPC.technological"),items:e.technological,type:"technological"},upgrade:{label:game.i18n.localize("MERCHANTNPC.upgrade"),items:e.upgrade,type:"Upgrade"},weapon:{label:game.i18n.localize("MERCHANTNPC.weapon"),items:e.weapon,type:"weapon"},weaponAccessory:{label:game.i18n.localize("MERCHANTNPC.weaponAccessory"),items:e.weaponAccessory,type:"weaponAccessory"}};return t.ammunition.items.sort(this.compare()),t.augmentation.items.sort(this.compare()),t.consumable.items.sort(this.compare()),t.container.items.sort(this.compare()),t.equipment.items.sort(this.compare()),t.fusion.items.sort(this.compare()),t.goods.items.sort(this.compare()),t.hybrid.items.sort(this.compare()),t.magic.items.sort(this.compare()),t.shield.items.sort(this.compare()),t.spell.items.sort(this.compare()),t.technological.items.sort(this.compare()),t.upgrade.items.sort(this.compare()),t.weapon.items.sort(this.compare()),t.weaponAccessory.items.sort(this.compare()),t}compare(){return function(e,t){return e.name.localeCompare(t.name)}}getPriceFromItem(e){return e.data.price}getPriceItemKey(){return"data.price"}currency(){return"credit"}}r.default=i},{"./CurrencyCalculator":10}],13:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(r,"__esModule",{value:!0}),n(e("./CurrencyCalculator")));class i extends n.default{actorCurrency(e){return e.data.data.details.currency}updateActorWithNewFunds(e,t){e.update({"data.details.currency":t})}prepareItems(e){console.log("Merchant Sheet | Prepare Features");const t={weapons:{label:game.i18n.localize("MERCHANTNPC.weapons"),items:[],type:"weapon"},armor:{label:game.i18n.localize("MERCHANTNPC.armor"),items:[],type:"armor"},shields:{label:game.i18n.localize("MERCHANTNPC.shields"),items:[],type:"shield"},gear:{label:game.i18n.localize("MERCHANTNPC.gear"),items:[],type:"gear"}};return t.gear.items=e.gear,t.gear.items.sort(this.compare()),t.armor.items=e.armor,t.armor.items.sort(this.compare()),t.shields.items=e.shield,t.shields.items.sort(this.compare()),t.weapons.items=e.weapon,t.weapons.items.sort(this.compare()),t}compare(){return function(e,t){return e.name.localeCompare(t.name)}}getPriceFromItem(e){return e.data.price}getPriceItemKey(){return"data.price"}priceInText(e){return e+" "+game.settings.get("swade","currencyName")}getDescription(e){return e}currency(){return""+game.settings.get("swade","currencyName")}}r.default=i},{"./CurrencyCalculator":10}],14:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(r,"__esModule",{value:!0}),n(e("./CurrencyCalculator")));const o=n(e("../../Utils/Logger"));class a extends i.default{async onDropItemCreate(e,t){return t.callSuperOnDropItemCreate(e)}actorCurrency(e){var e=e.getItemTypes("money").map(e=>e.toObject()),t=game.wfrp4e.market.getCharacterMoney(e);return this.getBPprice(this.getBasePriceFromItem(t,e))}getBasePriceFromItem(e,t){return{gc:t[e.gc].data.quantity.value,ss:t[e.ss].data.quantity.value,bp:t[e.bp].data.quantity.value}}buyerHaveNotEnoughFunds(e,t){return o.default.Log("Cost and funds",e,t),t<e}convertToPlatinum(e){return 1}updateActorWithNewFunds(e,t){console.log("Merchant sheet | buyer and funds",e,t),e.update({"data.currency":t})}subtractAmountFromActor(e,t,r){r=Math.round(r),r=game.wfrp4e.market.makeSomeChange(r,!1),r=game.wfrp4e.market.payCommand(r.gc+"gc "+r.ss+"ss "+r.bp+"bp",e,{suppressMessage:!0});r&&e.updateEmbeddedDocuments("Item",r)}addAmountForActor(e,t,r){r=Math.round(r),console.log("Sold for: ",r),r=game.wfrp4e.market.makeSomeChange(r,!1),r=game.wfrp4e.market.creditCommand(r.gc+"gc "+r.ss+"ss "+r.bp+"bp",e,{suppressMessage:!0});r&&e.updateEmbeddedDocuments("Item",r)}priceInText(e){e=Math.round(e),e=game.wfrp4e.market.makeSomeChange(e,!1);return e.gc+"GC "+e.ss+"SS "+e.bp+"BP"}prepareItems(e){console.log("Merchant Sheet | Prepare Features");const t={ammunition:{label:game.i18n.localize("MERCHANTNPC.ammunition"),items:[],type:"ammunition"},armour:{label:game.i18n.localize("MERCHANTNPC.armour"),items:[],type:"armour"},weapons:{label:game.i18n.localize("MERCHANTNPC.weapons"),items:[],type:"weapon"},container:{label:game.i18n.localize("MERCHANTNPC.container"),items:[],type:"container"},spell:{label:game.i18n.localize("MERCHANTNPC.spell"),items:[],type:"spell"},clothingAccessories:{label:game.i18n.localize("MERCHANTNPC.clothingAccessories"),items:[],type:"clothingAccessories"},foodAndDrink:{label:game.i18n.localize("MERCHANTNPC.foodAndDrink"),items:[],type:"foodAndDrink"},toolsAndKits:{label:game.i18n.localize("MERCHANTNPC.toolsAndKits"),items:[],type:"toolsAndKits"},booksAndDocuments:{label:game.i18n.localize("MERCHANTNPC.booksAndDocuments"),items:[],type:"booksAndDocuments"},tradeTools:{label:game.i18n.localize("MERCHANTNPC.tradeTools"),items:[],type:"tradeTools"},drugsPoisonsHerbsDraughts:{label:game.i18n.localize("MERCHANTNPC.drugsPoisonsHerbsDraughts"),items:[],type:"drugsPoisonsHerbsDraughts"},ingredient:{label:game.i18n.localize("MERCHANTNPC.ingredient"),items:[],type:"ingredient"},misc:{label:game.i18n.localize("MERCHANTNPC.misc"),items:[],type:"misc"}};t.weapons.items=e.weapon,t.weapons.items.sort(this.sort()),t.armour.items=e.armour,t.armour.items.sort(this.sort()),t.ammunition.items=e.ammunition,t.ammunition.items.sort(this.sort()),t.container.items=e.container,t.container.items.sort(this.sort()),t.spell.items=e.spell,t.spell.items.sort(this.sort());let r=e.trapping;return r.sort(this.sort()),t.clothingAccessories.items=r.filter(e=>void 0!==e.data.data.trappingType&&void 0!==e.data.data.trappingType.value&&"clothingAccessories"===e.data.data.trappingType.value),t.foodAndDrink.items=r.filter(e=>void 0!==e.data.data.trappingType&&void 0!==e.data.data.trappingType.value&&"foodAndDrink"===e.data.data.trappingType.value),t.toolsAndKits.items=r.filter(e=>void 0!==e.data.data.trappingType&&void 0!==e.data.data.trappingType.value&&"toolsAndKits"===e.data.data.trappingType.value),t.booksAndDocuments.items=r.filter(e=>void 0!==e.data.data.trappingType&&void 0!==e.data.data.trappingType.value&&"booksAndDocuments"===e.data.data.trappingType.value),t.tradeTools.items=r.filter(e=>void 0!==e.data.data.trappingType&&void 0!==e.data.data.trappingType.value&&"tradeTools"===e.data.data.trappingType.value),t.misc.items=r.filter(e=>void 0!==e.data.data.trappingType&&void 0!==e.data.data.trappingType.value&&"misc"===e.data.data.trappingType.value),t.ingredient.items=r.filter(e=>void 0!==e.data.data.trappingType&&void 0!==e.data.data.trappingType.value&&"ingredient"===e.data.data.trappingType.value),t.drugsPoisonsHerbsDraughts.items=r.filter(e=>void 0!==e.data.data.trappingType&&void 0!==e.data.data.trappingType.value&&"drugsPoisonsHerbsDraughts"===e.data.data.trappingType.value),t}sort(){return function(e,t){return e.name.localeCompare(t.name)}}initSettings(){var e=game.wfrp4e.market.makeSomeChange(100,!1);console.log(e),super.initSettings()}getPriceFromItem(e){return this.getBPprice(e.data.price)}getPriceItemKey(){return"data.price"}getQuantity(e){return e.value}getQuantityKey(){return"data.quantity.value"}setQuantityForItemData(e,t){e.quantity.value=t}getWeight(e){return e.encumbrance.value}getPriceOutputWithModifier(e,t){e=this.getBPprice(e),e=Math.round(Math.round(e*t*100)/100),t=game.wfrp4e.market.makeSomeChange(e,!1);return game.wfrp4e.market.amountToString(t)}getBPprice(e){var t=240*e.gc;return+(12*e.ss)+t+ +e.bp}getPrice(e){let t=game.wfrp4e.market.makeSomeChange(e,!0);return t.label="Price",t.type="String",t}currency(){return"BP"}inputStyle(){return"color: white; background: black"}editorStyle(){return"background: none; color: white"}sectionStyle(){return"color: black"}isPermissionShown(){return!1}}r.default=a},{"../../Utils/Logger":3,"./CurrencyCalculator":10}],15:[function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(r,"__esModule",{value:!0}),n(e("./CurrencyCalculator")));const o=n(e("../../Globals"));class a extends i.default{async onDropItemCreate(e,t){var r;return"spell"===e.type?(r=await this.createScroll(e),t.callSuperOnDropItemCreate(r)):t.callSuperOnDropItemCreate(e)}async createScrollFromSpell(e){var t=e,r=e.data.level,e=e.data.description,n=`Compendium.${CONFIG.DND5E.sourcePacks.ITEMS}.`+CONFIG.DND5E.spellScrollIds[r];const i=await fromUuid(n),o=i.toObject(),a=(delete o._id,o.data.description.value);var n="</p>",s=a.indexOf(n),l=a.slice(0,s+n.length),s=a.slice(s+n.length);const c=`${l}<hr/><h3>${t.name} (Level ${r})</h3><hr/>${e.value}<hr/><h3>Scroll Details</h3><hr/>`+s;let u=duplicate(t);return u.name=game.i18n.localize("DND5E.SpellScroll")+": "+t.name,u.img=o.img,u.type="consumable",u.data.description.value=c.trim(),u}async createScroll(e){return this.createScrollFromSpell(e)}getStandard(){return game.settings.get("world-currency-5e","Standard")}actorCurrency(e){var t=this.getStandard();return e.data.data.currency[t]}buyerHaveNotEnoughFunds(e,t){return t<e}updateActorWithNewFunds(e,t){console.log("Merchant sheet | buyer and funds",e,t),e.update({"data.currency.cp":t})}subtractAmountFromActor(e,t,r){this.updateActorWithNewFunds(e,t-=r),console.log("Merchant Sheet | Funds after purchase: "+t)}addAmountForActor(e,t,r){this.updateActorWithNewFunds(e,t=+t+ +r),console.log("Merchant Sheet | Funds after sell: "+t)}priceInText(e){this.getStandard();return e+" "+this.abbreviation()}prepareItems(e){console.log("Merchant Sheet | Prepare Features");const t={weapons:{label:game.i18n.localize("MERCHANTNPC.weapons"),items:[],type:"weapon"},equipment:{label:game.i18n.localize("MERCHANTNPC.equipment"),items:[],type:"equipment"},consumables:{label:game.i18n.localize("MERCHANTNPC.consumables"),items:[],type:"consumable"},tools:{label:game.i18n.localize("MERCHANTNPC.tools"),items:[],type:"tool"},containers:{label:game.i18n.localize("MERCHANTNPC.containers"),items:[],type:"container"},loot:{label:game.i18n.localize("MERCHANTNPC.loot"),items:[],type:"loot"}};return t.weapons.items=e.weapon,t.weapons.items.sort(this.sort()),t.equipment.items=e.equipment,t.equipment.items.sort(this.sort()),t.consumables.items=e.consumable,t.consumables.items.sort(this.sort()),t.tools.items=e.tool,t.tools.items.sort(this.sort()),t.containers.items=e.backpack,t.containers.items.sort(this.sort()),t.loot.items=e.loot,t.loot.items.sort(this.sort()),t}sort(){return function(e,t){return e.name.localeCompare(t.name)}}initSettings(){game.settings.register(o.default.ModuleName,"convertCurrency",{name:"Convert currency after purchases?",hint:"If enabled, all currency will be converted to the highest denomination possible after a purchase. If disabled, currency will subtracted simply.",scope:"world",config:!0,default:!1,type:Boolean}),$,super.initSettings()}gpToStandard(e){var t=this.getStandard();return e*CONFIG.DND5E.currencies.gp.conversion[t]}standardToGp(e){var t=this.getStandard();return e/CONFIG.DND5E.currencies.gp.conversion[t]}getPriceFromItem(e){return this.gpToStandard(e.data.price)}getPriceItemKey(){return"data.price"}getPrice(e){return this.standardToGp(e)}currency(){var e=this.getStandard();return CONFIG.DND5E.currencies[e].label}abbreviation(){var e=this.getStandard();return" "+CONFIG.DND5E.currencies[e].abbreviation}getPriceOutputWithModifier(e,t){return this.gpToStandard(Math.round(e*t*100)/100).toLocaleString("en")+this.abbreviation()}}r.default=a},{"../../Globals":1,"./CurrencyCalculator":10}],16:[function(M,E,e){!function(d){!function(){"use strict";var e=M("object-assign");function h(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}function p(e){return d.Buffer&&"function"==typeof d.Buffer.isBuffer?d.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var m=M("util/"),n=Object.prototype.hasOwnProperty,g=Array.prototype.slice,t="foo"===function(){}.name;function y(e){return Object.prototype.toString.call(e)}function b(e){return!p(e)&&("function"==typeof d.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var o=E.exports=u,r=/\s*function\s+([^\(\s]*)\s*/;function i(e){if(m.isFunction(e)){if(t)return e.name;e=e.toString().match(r);return e&&e[1]}}function s(e,t){return"string"!=typeof e||e.length<t?e:e.slice(0,t)}function l(e){if(t||!m.isFunction(e))return m.inspect(e);e=i(e);return"[Function"+(e?": "+e:"")+"]"}function a(e,t,r,n,i){throw new o.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:i})}function u(e,t){e||a(e,!0,t,"==",o.ok)}function v(e,t,c,r){if(e===t)return!0;if(p(e)&&p(t))return 0===h(e,t);if(m.isDate(e)&&m.isDate(t))return e.getTime()===t.getTime();if(m.isRegExp(e)&&m.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(b(e)&&b(t)&&y(e)===y(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===h(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(p(e)!==p(t))return!1;var n=(r=r||{actual:[],expected:[]}).actual.indexOf(e);if(-1!==n&&n===r.expected.indexOf(t))return!0;r.actual.push(e),r.expected.push(t);var i=e,o=t,a=c,f=r;if(null==i||null==o)return!1;if(m.isPrimitive(i)||m.isPrimitive(o))return i===o;if(a&&Object.getPrototypeOf(i)!==Object.getPrototypeOf(o))return!1;n=_(i),r=_(o);if(n&&!r||!n&&r)return!1;if(n)return i=g.call(i),o=g.call(o),v(i,o,a);var s,l,u=w(i),d=w(o);if(u.length!==d.length)return!1;for(u.sort(),d.sort(),l=u.length-1;0<=l;l--)if(u[l]!==d[l])return!1;for(l=u.length-1;0<=l;l--)if(s=u[l],!v(i[s],o[s],a,f))return!1;return!0}return c?e===t:e==t}function _(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function c(e,t){if(e&&t){if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return 1}catch(e){}return Error.isPrototypeOf(t)?void 0:!0===t.call({},e)}}function f(e,t,r,n){if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),t=function(e){var t;try{e()}catch(e){t=e}return t}(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!t&&a(t,r,"Missing expected exception"+n);var i="string"==typeof n,o=!e&&t&&!r;if((!e&&m.isError(t)&&i&&c(t,r)||o)&&a(t,r,"Got unwanted exception"+n),e&&t&&r&&!c(t,r)||!e&&t)throw t}o.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=s(l((r=this).actual),128)+" "+r.operator+" "+s(l(r.expected),128),this.generatedMessage=!0);var t,r=e.stackStartFunction||a;Error.captureStackTrace?Error.captureStackTrace(this,r):(e=new Error).stack&&(e=e.stack,t=i(r),0<=(t=e.indexOf("\n"+t))&&(t=e.indexOf("\n",t+1),e=e.substring(t+1)),this.stack=e)},m.inherits(o.AssertionError,Error),o.fail=a,o.ok=u,o.equal=function(e,t,r){e!=t&&a(e,t,r,"==",o.equal)},o.notEqual=function(e,t,r){e==t&&a(e,t,r,"!=",o.notEqual)},o.deepEqual=function(e,t,r){v(e,t,!1)||a(e,t,r,"deepEqual",o.deepEqual)},o.deepStrictEqual=function(e,t,r){v(e,t,!0)||a(e,t,r,"deepStrictEqual",o.deepStrictEqual)},o.notDeepEqual=function(e,t,r){v(e,t,!1)&&a(e,t,r,"notDeepEqual",o.notDeepEqual)},o.notDeepStrictEqual=function e(t,r,n){v(t,r,!0)&&a(t,r,n,"notDeepStrictEqual",e)},o.strictEqual=function(e,t,r){e!==t&&a(e,t,r,"===",o.strictEqual)},o.notStrictEqual=function(e,t,r){e===t&&a(e,t,r,"!==",o.notStrictEqual)},o.throws=function(e,t,r){f(!0,e,t,r)},o.doesNotThrow=function(e,t,r){f(!1,e,t,r)},o.ifError=function(e){if(e)throw e},o.strict=e(function e(t,r){t||a(t,!0,r,"==",e)},o,{equal:o.strictEqual,deepEqual:o.deepStrictEqual,notEqual:o.notStrictEqual,notDeepEqual:o.notDeepStrictEqual}),o.strict.strict=o.strict;var w=Object.keys||function(e){var t,r=[];for(t in e)n.call(e,t)&&r.push(t);return r}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"object-assign":35,"util/":19}],17:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;function r(){}r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],18:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],19:[function(N,e,T){!function(S,C){!function(){var n,u=/%[sdj%]/g,e=(T.format=function(e){if(!d(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}for(var r=1,n=arguments,i=n.length,o=String(e).replace(u,function(e){if("%%"===e)return"%";if(i<=r)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<i;a=n[++r])f(a)||!l(a)?o+=" "+a:o+=" "+s(a);return o},T.deprecate=function(e,t){if(h(C.process))return function(){return T.deprecate(e,t).apply(this,arguments)};if(!0===S.noDeprecation)return e;var r=!1;return function(){if(!r){if(S.throwDeprecation)throw new Error(t);S.traceDeprecation?console.trace(t):console.error(t),r=!0}return e.apply(this,arguments)}},{});function s(e,t){var r={seen:[],stylize:o};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),_(t)?r.showHidden=t:t&&T._extend(r,t),h(r.showHidden)&&(r.showHidden=!1),h(r.depth)&&(r.depth=2),h(r.colors)&&(r.colors=!1),h(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),c(r,e,r.depth)}function i(e,t){t=s.styles[t];return t?"["+s.colors[t][0]+"m"+e+"["+s.colors[t][1]+"m":e}function o(e,t){return e}function c(t,r,n){if(t.customInspect&&r&&g(r.inspect)&&r.inspect!==T.inspect&&(!r.constructor||r.constructor.prototype!==r))return d(e=r.inspect(n,t))?e:c(t,e,n);var e=function(e,t){if(h(t))return e.stylize("undefined","undefined");{var r;if(d(t))return r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",e.stylize(r,"string")}return w(t)?e.stylize(""+t,"number"):_(t)?e.stylize(""+t,"boolean"):f(t)?e.stylize("null","null"):void 0}(t,r);if(e)return e;var i,e=Object.keys(r),o=(i={},e.forEach(function(e,t){i[e]=!0}),i);if(t.showHidden&&(e=Object.getOwnPropertyNames(r)),m(r)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return y(r);if(0===e.length){if(g(r))return a=r.name?": "+r.name:"",t.stylize("[Function"+a+"]","special");if(p(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(M(r))return t.stylize(Date.prototype.toString.call(r),"date");if(m(r))return y(r)}var a="",s=!1,l=["{","}"];if(v(r)&&(s=!0,l=["[","]"]),g(r)&&(a=" [Function"+(r.name?": "+r.name:"")+"]"),p(r)&&(a=" "+RegExp.prototype.toString.call(r)),M(r)&&(a=" "+Date.prototype.toUTCString.call(r)),m(r)&&(a=" "+y(r)),0===e.length&&(!s||0==r.length))return l[0]+a+l[1];if(n<0)return p(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special");t.seen.push(r),u=s?function(t,r,n,i,e){for(var o=[],a=0,s=r.length;a<s;++a)E(r,String(a))?o.push(b(t,r,n,i,String(a),!0)):o.push("");return e.forEach(function(e){e.match(/^\d+$/)||o.push(b(t,r,n,i,e,!0))}),o}(t,r,n,o,e):e.map(function(e){return b(t,r,n,o,e,s)}),t.seen.pop();var u;return 60<u.reduce(function(e,t){return 0<=t.indexOf("\n")&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)?l[0]+(""===a?"":a+"\n ")+" "+u.join(",\n  ")+" "+l[1]:l[0]+a+" "+u.join(", ")+" "+l[1]}function y(e){return"["+Error.prototype.toString.call(e)+"]"}function b(e,t,r,n,i,o){var a,s,t=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]};if(t.get?s=t.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):t.set&&(s=e.stylize("[Setter]","special")),E(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(t.value)<0?-1<(s=f(r)?c(e,t.value,null):c(e,t.value,r-1)).indexOf("\n")&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),h(a)){if(o&&i.match(/^\d+$/))return s;a=(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e.stylize(a,"string"))}return a+": "+s}function v(e){return Array.isArray(e)}function _(e){return"boolean"==typeof e}function f(e){return null===e}function w(e){return"number"==typeof e}function d(e){return"string"==typeof e}function h(e){return void 0===e}function p(e){return l(e)&&"[object RegExp]"===t(e)}function l(e){return"object"==typeof e&&null!==e}function M(e){return l(e)&&"[object Date]"===t(e)}function m(e){return l(e)&&("[object Error]"===t(e)||e instanceof Error)}function g(e){return"function"==typeof e}function t(e){return Object.prototype.toString.call(e)}function r(e){return e<10?"0"+e.toString(10):e.toString(10)}T.debuglog=function(t){var r;return h(n)&&(n=S.env.NODE_DEBUG||""),t=t.toUpperCase(),e[t]||(new RegExp("\\b"+t+"\\b","i").test(n)?(r=S.pid,e[t]=function(){var e=T.format.apply(T,arguments);console.error("%s %d: %s",t,r,e)}):e[t]=function(){}),e[t]},(T.inspect=s).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},T.isArray=v,T.isBoolean=_,T.isNull=f,T.isNullOrUndefined=function(e){return null==e},T.isNumber=w,T.isString=d,T.isSymbol=function(e){return"symbol"==typeof e},T.isUndefined=h,T.isRegExp=p,T.isObject=l,T.isDate=M,T.isError=m,T.isFunction=g,T.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},T.isBuffer=N("./support/isBuffer");var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}T.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[r(e.getHours()),r(e.getMinutes()),r(e.getSeconds())].join(":"),[e.getDate(),a[e.getMonth()],t].join(" ")),T.format.apply(T,arguments))},T.inherits=N("inherits"),T._extend=function(e,t){if(!t||!l(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}.call(this)}.call(this,N("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":18,_process:36,inherits:17}],20:[function(e,o,t){"use strict";t.byteLength=function(e){var e=c(e),t=e[0],e=e[1];return 3*(t+e)/4-e},t.toByteArray=function(e){var t,r,n=c(e),i=n[0],n=n[1],o=new u(function(e,t){return 3*(e+t)/4-t}(i,n)),a=0,s=0<n?i-4:i;for(r=0;r<s;r+=4)t=l[e.charCodeAt(r)]<<18|l[e.charCodeAt(r+1)]<<12|l[e.charCodeAt(r+2)]<<6|l[e.charCodeAt(r+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;2===n&&(t=l[e.charCodeAt(r)]<<2|l[e.charCodeAt(r+1)]>>4,o[a++]=255&t);1===n&&(t=l[e.charCodeAt(r)]<<10|l[e.charCodeAt(r+1)]<<4|l[e.charCodeAt(r+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t);return o},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],o=0,a=r-n;o<a;o+=16383)i.push(function(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(function(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}(n));return i.join("")}(e,o,a<o+16383?a:o+16383));1==n?(t=e[r-1],i.push(s[t>>2]+s[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],i.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return i.join("")};for(var s=[],l=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=0,i=r.length;n<i;++n)s[n]=r[n],l[r.charCodeAt(n)]=n;function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},{}],21:[function(e,t,r){},{}],22:[function(O,e,R){!function(e){!function(){"use strict";var S=O("base64-js"),o=O("ieee754"),t=(R.Buffer=f,R.SlowBuffer=function(e){+e!=e&&(e=0);return f.alloc(+e)},R.INSPECT_MAX_BYTES=50,2147483647);function l(e){if(t<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return e.__proto__=f.prototype,e}function f(e,t,r){if("number"!=typeof e)return n(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}function n(e,t,r){if("string"==typeof e){var n=e,i=t;if(!f.isEncoding(i="string"!=typeof i||""===i?"utf8":i))throw new TypeError("Unknown encoding: "+i);var o=0|p(n,i),a=l(o);return a=(n=a.write(n,i))!==o?a.slice(0,n):a}if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(d(e,ArrayBuffer)||e&&d(e.buffer,ArrayBuffer)){i=e,o=t,n=r;if(o<0||i.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<o+(n||0))throw new RangeError('"length" is outside of buffer bounds');return(i=void 0===o&&void 0===n?new Uint8Array(i):void 0===n?new Uint8Array(i,o):new Uint8Array(i,o,n)).__proto__=f.prototype,i}if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return f.from(a,t,r);var s=function(e){{var t,r;if(f.isBuffer(e))return t=0|h(e.length),0===(r=l(t)).length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||A(e.length)?l(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return f.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function i(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return i(e),l(e<0?0:0|h(e))}function c(e){for(var t=e.length<0?0:0|h(e.length),r=l(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e){if(t<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function p(e,t){if(f.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||d(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return I(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return k(e).length;default:if(i)return n?-1:I(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){var n,c=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var f=this,i=t,o=r,a=f.length;(!o||o<0||a<o)&&(o=a);for(var d="",s=i=!i||i<0?0:i;s<o;++s)d+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(f[s]);return d;case"utf8":case"utf-8":return C(this,t,r);case"ascii":var h=this,a=t,p=r,m="";p=Math.min(h.length,p);for(var g=a;g<p;++g)m+=String.fromCharCode(127&h[g]);return m;case"latin1":case"binary":var y=this,i=t,b=r,v="";b=Math.min(y.length,b);for(var _=i;_<b;++_)v+=String.fromCharCode(y[_]);return v;case"base64":return l=this,n=r,0===(w=t)&&n===l.length?S.fromByteArray(l):S.fromByteArray(l.slice(w,n));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var l=t,w=r,M=this.slice(l,w),E="",u=0;u<M.length;u+=2)E+=String.fromCharCode(M[u]+256*M[u+1]);return E;default:if(c)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),c=!0}}function r(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=A(r=+r)?i?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=f.from(t,n)),f.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,c){var i=1,o=e.length,a=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o/=i=2,a/=2,r/=2}function s(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(c)for(var l=-1,u=r;u<o;u++)if(s(e,u)===s(t,-1===l?0:u-l)){if(u-(l=-1===l?u:l)+1===a)return l*i}else-1!==l&&(u-=u-l),l=-1;else for(u=r=o<r+a?o-a:r;0<=u;u--){for(var f=!0,d=0;d<a;d++)if(s(e,u+d)!==s(t,d)){f=!1;break}if(f)return u}return-1}function v(e,t,r,n){return g(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return g(function(e,t){for(var r,n,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,n=n%256,i.push(n),i.push(r);return i}(t,e.length-r),e,r,n)}function C(e,c,t){t=Math.min(e.length,t);for(var r=[],n=c;n<t;){var i,o,f,a,s=e[n],l=null,u=239<s?4:223<s?3:191<s?2:1;if(n+u<=t)switch(u){case 1:s<128&&(l=s);break;case 2:128==(192&(i=e[n+1]))&&127<(a=(31&s)<<6|63&i)&&(l=a);break;case 3:i=e[n+1],o=e[n+2],128==(192&i)&&128==(192&o)&&2047<(a=(15&s)<<12|(63&i)<<6|63&o)&&(a<55296||57343<a)&&(l=a);break;case 4:i=e[n+1],o=e[n+2],f=e[n+3],128==(192&i)&&128==(192&o)&&128==(192&f)&&65535<(a=(15&s)<<18|(63&i)<<12|(63&o)<<6|63&f)&&a<1114112&&(l=a)}null===l?(l=65533,u=1):65535<l&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),n+=u}var d=r,h=d.length;if(h<=w)return String.fromCharCode.apply(String,d);for(var p="",m=0;m<h;)p+=String.fromCharCode.apply(String,d.slice(m,m+=w));return p}R.kMaxLength=t,(f.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),f.poolSize=8192,f.from=n,f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,f.alloc=function(e,t,r){return t=t,r=r,i(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?l(e).fill(t,r):l(e).fill(t):l(e)},f.allocUnsafe=u,f.allocUnsafeSlow=u,f.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==f.prototype},f.compare=function(e,t){if(d(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),d(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),!f.isBuffer(e)||!f.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var r=f.allocUnsafe(t),n=0,i=0;i<e.length;++i){var o=e[i];if(d(o,Uint8Array)&&(o=f.from(o)),!f.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,n),n+=o.length}return r},f.byteLength=p,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)r(this,t,t+1);return this},f.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)r(this,t,t+3),r(this,t+1,t+2);return this},f.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)r(this,t,t+7),r(this,t+1,t+6),r(this,t+2,t+5),r(this,t+3,t+4);return this},f.prototype.toLocaleString=f.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===f.compare(this,e)},f.prototype.inspect=function(){var e="",t=R.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},f.prototype.compare=function(e,t,r,n,i){if(d(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),(t=void 0===t?0:t)<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(i<=n&&r<=t)return 0;if(i<=n)return-1;if(r<=t)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),c=Math.min(o,a),s=this.slice(n,i),l=e.slice(t,r),u=0;u<c;++u)if(s[u]!==l[u]){o=s[u],a=l[u];break}return o<a?-1:a<o?1:0},f.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},f.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},f.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},f.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var c=this.length-t;if((void 0===r||c<r)&&(r=c),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var f,i,o,d=!1;;)switch(n){case"hex":var h=this,p=e,a=t,s=r,l=(a=Number(a)||0,h.length-a);(!s||l<(s=Number(s)))&&(s=l),(l=p.length)/2<s&&(s=l/2);for(var u=0;u<s;++u){var m=parseInt(p.substr(2*u,2),16);if(A(m))return u;h[a+u]=m}return u;case"utf8":case"utf-8":return l=t,o=r,g(I(e,(i=this).length-l),i,l,o);case"ascii":return v(this,e,t,r);case"latin1":case"binary":return v(this,e,t,r);case"base64":return i=this,o=t,f=r,g(k(e),i,o,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,r);default:if(d)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),d=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function a(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function s(e,t,r,n,i,o){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function M(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function E(e,t,r,n,i){return t=+t,r>>>=0,i||M(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function N(e,t,r,n,i){return t=+t,r>>>=0,i||M(e,0,r,8),o.write(e,t,r,n,52,8),r+8}f.prototype.slice=function(e,t){var r=this.length,r=((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),this.subarray(e,t));return r.__proto__=f.prototype,r},f.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||a(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},f.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||a(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},f.prototype.readUInt8=function(e,t){return e>>>=0,t||a(e,1,this.length),this[e]},f.prototype.readUInt16LE=function(e,t){return e>>>=0,t||a(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUInt16BE=function(e,t){return e>>>=0,t||a(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUInt32LE=function(e,t){return e>>>=0,t||a(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUInt32BE=function(e,t){return e>>>=0,t||a(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||a(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return(i*=128)<=n&&(n-=Math.pow(2,8*t)),n},f.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||a(e,t,this.length);for(var n=t,i=1,o=this[e+--n];0<n&&(i*=256);)o+=this[e+--n]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*t)),o},f.prototype.readInt8=function(e,t){return e>>>=0,t||a(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){e>>>=0,t||a(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},f.prototype.readInt16BE=function(e,t){e>>>=0,t||a(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},f.prototype.readInt32LE=function(e,t){return e>>>=0,t||a(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return e>>>=0,t||a(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readFloatLE=function(e,t){return e>>>=0,t||a(e,4,this.length),o.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return e>>>=0,t||a(e,4,this.length),o.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return e>>>=0,t||a(e,8,this.length),o.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return e>>>=0,t||a(e,8,this.length),o.read(this,e,!1,52,8)},f.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||s(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},f.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||s(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;0<=--i&&(o*=256);)this[t+i]=e/o&255;return t+r},f.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,1,255,0),this[t]=255&e,t+1},f.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},f.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||s(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=0,o=1,a=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},f.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||s(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=r-1,o=1,a=0;for(this[t+i]=255&e;0<=--i&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},f.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},f.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},f.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||s(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeFloatLE=function(e,t,r){return E(this,e,t,!0,r)},f.prototype.writeFloatBE=function(e,t,r){return E(this,e,t,!1,r)},f.prototype.writeDoubleLE=function(e,t,r){return N(this,e,t,!0,r)},f.prototype.writeDoubleBE=function(e,t,r){return N(this,e,t,!1,r)},f.prototype.copy=function(e,t,r,n){if(!f.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,n||0===n||(n=this.length),t>=e.length&&(t=e.length),(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var i=(n=e.length-t<n-r?e.length-t+r:n)-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var o=i-1;0<=o;--o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},f.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var i;1===e.length&&(i=e.charCodeAt(0),("utf8"===n&&i<128||"latin1"===n)&&(e=i))}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(e=e||0))for(o=t;o<r;++o)this[o]=e;else{var a=f.isBuffer(e)?e:f.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var T=/[^+/0-9A-Za-z-_]/g;function I(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],a=0;a<n;++a){if(55295<(r=e.charCodeAt(a))&&r<57344){if(!i){if(56319<r){-1<(t-=3)&&o.push(239,191,189);continue}if(a+1===n){-1<(t-=3)&&o.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(t-=3)&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(t-=3)&&o.push(239,191,189);if(i=null,r<128){if(--t<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function k(e){return S.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(T,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function g(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function d(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function A(e){return e!=e}}.call(this)}.call(this,O("buffer").Buffer)},{"base64-js":20,buffer:22,ieee754:33}],23:[function(e,t,u){var r,s=e("color-name"),l={};for(r in s)s.hasOwnProperty(r)&&(l[s[r]]=r);var n,o=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(n in o)if(o.hasOwnProperty(n)){if(!("channels"in o[n]))throw new Error("missing channels property: "+n);if(!("labels"in o[n]))throw new Error("missing channel labels property: "+n);if(o[n].labels.length!==o[n].channels)throw new Error("channel and label counts mismatch: "+n);var i=o[n].channels,a=o[n].labels;delete o[n].channels,delete o[n].labels,Object.defineProperty(o[n],"channels",{value:i}),Object.defineProperty(o[n],"labels",{value:a})}o.rgb.hsl=function(e){var t,r=e[0]/255,n=e[1]/255,e=e[2]/255,i=Math.min(r,n,e),o=Math.max(r,n,e),a=o-i;return o===i?t=0:r===o?t=(n-e)/a:n===o?t=2+(e-r)/a:e===o&&(t=4+(r-n)/a),(t=Math.min(60*t,360))<0&&(t+=360),e=(i+o)/2,[t,100*(o===i?0:e<=.5?a/(o+i):a/(2-o-i)),100*e]},o.rgb.hsv=function(e){function t(e){return(u-e)/6/c+.5}var r,n,i,o,a,s=e[0]/255,l=e[1]/255,e=e[2]/255,u=Math.max(s,l,e),c=u-Math.min(s,l,e);return 0==c?o=a=0:(a=c/u,r=t(s),n=t(l),i=t(e),s===u?o=i-n:l===u?o=1/3+r-i:e===u&&(o=2/3+n-r),o<0?o+=1:1<o&&--o),[360*o,100*a,100*u]},o.rgb.hwb=function(e){var t=e[0],r=e[1],n=e[2];return[o.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(r,n))),100*(1-1/255*Math.max(t,Math.max(r,n)))]},o.rgb.cmyk=function(e){var t=e[0]/255,r=e[1]/255,e=e[2]/255,n=Math.min(1-t,1-r,1-e);return[100*((1-t-n)/(1-n)||0),100*((1-r-n)/(1-n)||0),100*((1-e-n)/(1-n)||0),100*n]},o.rgb.keyword=function(e){var t=l[e];if(t)return t;var r,n,i,o,a=1/0;for(n in s)s.hasOwnProperty(n)&&(o=s[n],i=e,o=o,(i=Math.pow(i[0]-o[0],2)+Math.pow(i[1]-o[1],2)+Math.pow(i[2]-o[2],2))<a&&(a=i,r=n));return r},o.keyword.rgb=function(e){return s[e]},o.rgb.xyz=function(e){var t=e[0]/255,r=e[1]/255,e=e[2]/255;return[100*(.4124*(t=.04045<t?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(r=.04045<r?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(e=.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92)),100*(.2126*t+.7152*r+.0722*e),100*(.0193*t+.1192*r+.9505*e)]},o.rgb.lab=function(e){var e=o.rgb.xyz(e),t=e[0],r=e[1],e=e[2];return r/=100,e/=108.883,t=.008856<(t/=95.047)?Math.pow(t,1/3):7.787*t+16/116,[116*(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(e=.008856<e?Math.pow(e,1/3):7.787*e+16/116))]},o.hsl.rgb=function(e){var t,r,n=e[0]/360,i=e[1]/100,e=e[2]/100;if(0==i)return[r=255*e,r,r];for(var o,a=2*e-(o=e<.5?e*(1+i):e+i-e*i),s=[0,0,0],l=0;l<3;l++)(t=n+1/3*-(l-1))<0&&t++,1<t&&t--,s[l]=255*(r=6*t<1?a+6*(o-a)*t:2*t<1?o:3*t<2?a+(o-a)*(2/3-t)*6:a);return s},o.hsl.hsv=function(e){var t=e[0],r=e[1]/100,e=e[2]/100,n=r,i=Math.max(e,.01);return r*=(e*=2)<=1?e:2-e,n*=i<=1?i:2-i,[t,100*(0==e?2*n/(i+n):2*r/(e+r)),100*((e+r)/2)]},o.hsv.rgb=function(e){var t=e[0]/60,r=e[1]/100,n=e[2]/100,e=Math.floor(t)%6,t=t-Math.floor(t),i=255*n*(1-r),o=255*n*(1-r*t),a=255*n*(1-r*(1-t));switch(n*=255,e){case 0:return[n,a,i];case 1:return[o,n,i];case 2:return[i,n,a];case 3:return[i,o,n];case 4:return[a,i,n];case 5:return[n,i,o]}},o.hsv.hsl=function(e){var t=e[0],r=e[1]/100,e=e[2]/100,n=Math.max(e,.01),e=(2-r)*e,i=(2-r)*n,r=r*n;return[t,100*((r/=i<=1?i:2-i)||0),100*(e/=2)]},o.hwb.rgb=function(e){var t,r,n,i,o,a=e[0]/360,s=e[1]/100,e=e[2]/100,l=s+e;switch(1<l&&(s/=l,e/=l),a=6*a-(l=Math.floor(6*a)),r=s+(a=0!=(1&l)?1-a:a)*((t=1-e)-s),l){default:case 6:case 0:n=t,i=r,o=s;break;case 1:n=r,i=t,o=s;break;case 2:n=s,i=t,o=r;break;case 3:n=s,i=r,o=t;break;case 4:n=r,i=s,o=t;break;case 5:n=t,i=s,o=r}return[255*n,255*i,255*o]},o.cmyk.rgb=function(e){var t=e[0]/100,r=e[1]/100,n=e[2]/100,e=e[3]/100;return[255*(1-Math.min(1,t*(1-e)+e)),255*(1-Math.min(1,r*(1-e)+e)),255*(1-Math.min(1,n*(1-e)+e))]},o.xyz.rgb=function(e){var t=e[0]/100,r=e[1]/100,e=e[2]/100,n=3.2406*t+-1.5372*r+-.4986*e,i=-.9689*t+1.8758*r+.0415*e,t=.0557*t+-.204*r+1.057*e;return n=.0031308<n?1.055*Math.pow(n,1/2.4)-.055:12.92*n,i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:12.92*i,t=.0031308<t?1.055*Math.pow(t,1/2.4)-.055:12.92*t,[255*(n=Math.min(Math.max(0,n),1)),255*(i=Math.min(Math.max(0,i),1)),255*(t=Math.min(Math.max(0,t),1))]},o.xyz.lab=function(e){var t=e[0],r=e[1],e=e[2];return r/=100,e/=108.883,t=.008856<(t/=95.047)?Math.pow(t,1/3):7.787*t+16/116,[116*(r=.008856<r?Math.pow(r,1/3):7.787*r+16/116)-16,500*(t-r),200*(r-(e=.008856<e?Math.pow(e,1/3):7.787*e+16/116))]},o.lab.xyz=function(e){var t=(e[0]+16)/116,r=e[1]/500+t,e=t-e[2]/200,n=Math.pow(t,3),i=Math.pow(r,3),o=Math.pow(e,3);return t=.008856<n?n:(t-16/116)/7.787,r=.008856<i?i:(r-16/116)/7.787,e=.008856<o?o:(e-16/116)/7.787,[r*=95.047,t*=100,e*=108.883]},o.lab.lch=function(e){var t=e[0],r=e[1],e=e[2],n=360*Math.atan2(e,r)/2/Math.PI;return n<0&&(n+=360),[t,Math.sqrt(r*r+e*e),n]},o.lch.lab=function(e){var t=e[0],r=e[1],e=e[2]/360*2*Math.PI;return[t,r*Math.cos(e),r*Math.sin(e)]},o.rgb.ansi16=function(e){var t=e[0],r=e[1],n=e[2],i=1 in arguments?arguments[1]:o.rgb.hsv(e)[2];if(0===(i=Math.round(i/50)))return 30;n=30+(Math.round(n/255)<<2|Math.round(r/255)<<1|Math.round(t/255));return 2===i&&(n+=60),n},o.hsv.ansi16=function(e){return o.rgb.ansi16(o.hsv.rgb(e),e[2])},o.rgb.ansi256=function(e){var t=e[0],r=e[1],e=e[2];return t===r&&r===e?t<8?16:248<t?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(e/255*5)},o.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return 50<e&&(t+=3.5),[t=t/10.5*255,t,t];e=.5*(1+~~(50<e));return[(1&t)*e*255,(t>>1&1)*e*255,(t>>2&1)*e*255]},o.ansi256.rgb=function(e){var t;return 232<=e?[t=10*(e-232)+8,t,t]:(e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255])},o.rgb.hex=function(e){e=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},o.hex.rgb=function(e){e=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var t=e[0],e=(3===e[0].length&&(t=t.split("").map(function(e){return e+e}).join("")),parseInt(t,16));return[e>>16&255,e>>8&255,255&e]},o.rgb.hcg=function(e){var t=e[0]/255,r=e[1]/255,e=e[2]/255,n=Math.max(Math.max(t,r),e),i=Math.min(Math.min(t,r),e),o=n-i,i=o<1?i/(1-o):0,n=o<=0?0:n===t?(r-e)/o%6:n===r?2+(e-t)/o:4+(t-r)/o+4;return[360*(n=n/6%1),100*o,100*i]},o.hsl.hcg=function(e){var t=e[1]/100,r=e[2]/100,n=1,i=0,n=r<.5?2*t*r:2*t*(1-r);return[e[0],100*n,100*(i=n<1?(r-.5*n)/(1-n):i)]},o.hsv.hcg=function(e){var t=e[1]/100,r=e[2]/100,t=t*r,r=t<1?(r-t)/(1-t):0;return[e[0],100*t,100*r]},o.hcg.rgb=function(e){var t=e[0]/360,r=e[1]/100,e=e[2]/100;if(0==r)return[255*e,255*e,255*e];var n=[0,0,0],t=t%1*6,i=t%1,o=1-i;switch(Math.floor(t)){case 0:n[0]=1,n[1]=i,n[2]=0;break;case 1:n[0]=o,n[1]=1,n[2]=0;break;case 2:n[0]=0,n[1]=1,n[2]=i;break;case 3:n[0]=0,n[1]=o,n[2]=1;break;case 4:n[0]=i,n[1]=0,n[2]=1;break;default:n[0]=1,n[1]=0,n[2]=o}return[255*(r*n[0]+(t=(1-r)*e)),255*(r*n[1]+t),255*(r*n[2]+t)]},o.hcg.hsv=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t),t=0<r?t/r:0;return[e[0],100*t,100*r]},o.hcg.hsl=function(e){var t=e[1]/100,r=e[2]/100*(1-t)+.5*t,n=0;return 0<r&&r<.5?n=t/(2*r):.5<=r&&r<1&&(n=t/(2*(1-r))),[e[0],100*n,100*r]},o.hcg.hwb=function(e){var t=e[1]/100,r=t+e[2]/100*(1-t);return[e[0],100*(r-t),100*(1-r)]},o.hwb.hcg=function(e){var t=e[1]/100,r=1-e[2]/100,t=r-t,r=t<1?(r-t)/(1-t):0;return[e[0],100*t,100*r]},o.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},o.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},o.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},o.gray.hsl=o.gray.hsv=function(e){return[0,0,e[0]]},o.gray.hwb=function(e){return[0,100,e[0]]},o.gray.cmyk=function(e){return[0,0,0,e[0]]},o.gray.lab=function(e){return[e[0],0,0]},o.gray.hex=function(e){e=255&Math.round(e[0]/100*255),e=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(e.length)+e},o.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},{"color-name":26}],24:[function(e,t,r){var i=e("./conversions"),o=e("./route"),a={};function s(t){function e(e){return null==e?e:(1<arguments.length&&(e=Array.prototype.slice.call(arguments)),t(e))}return"conversion"in t&&(e.conversion=t.conversion),e}function l(i){function e(e){if(null==e)return e;1<arguments.length&&(e=Array.prototype.slice.call(arguments));var t=i(e);if("object"==typeof t)for(var r=t.length,n=0;n<r;n++)t[n]=Math.round(t[n]);return t}return"conversion"in i&&(e.conversion=i.conversion),e}Object.keys(i).forEach(function(r){a[r]={},Object.defineProperty(a[r],"channels",{value:i[r].channels}),Object.defineProperty(a[r],"labels",{value:i[r].labels});var n=o(r);Object.keys(n).forEach(function(e){var t=n[e];a[r][e]=l(t),a[r][e].raw=s(t)})}),t.exports=a},{"./conversions":23,"./route":25}],25:[function(e,t,r){var u=e("./conversions");function s(e){var t=function(){for(var e={},t=Object.keys(u),r=t.length,n=0;n<r;n++)e[t[n]]={distance:-1,parent:null};return e}(),r=[e];for(t[e].distance=0;r.length;)for(var n=r.pop(),i=Object.keys(u[n]),o=i.length,a=0;a<o;a++){var s=i[a],l=t[s];-1===l.distance&&(l.distance=t[n].distance+1,l.parent=n,r.unshift(s))}return t}function l(e,t){for(var r=[t[e].parent,e],n=u[t[e].parent][e],i=t[e].parent;t[i].parent;)r.unshift(t[i].parent),n=function(t,r){return function(e){return r(t(e))}}(u[t[i].parent][i],n),i=t[i].parent;return n.conversion=r,n}t.exports=function(e){for(var t=s(e),r={},n=Object.keys(t),i=n.length,o=0;o<i;o++){var a=n[o];null!==t[a].parent&&(r[a]=l(a,t))}return r}},{"./conversions":23}],26:[function(e,t,r){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],27:[function(e,t,c){var r,a=e("color-name"),i=e("simple-swizzle"),s=Object.hasOwnProperty,n={};for(r in a)s.call(a,r)&&(n[a[r]]=r);var o=t.exports={to:{},get:{}};function l(e,t,r){return Math.min(Math.max(t,e),r)}function u(e){e=Math.round(e).toString(16).toUpperCase();return e.length<2?"0"+e:e}o.get=function(e){var t,r;switch(e.substring(0,3).toLowerCase()){case"hsl":t=o.get.hsl(e),r="hsl";break;case"hwb":t=o.get.hwb(e),r="hwb";break;default:t=o.get.rgb(e),r="rgb"}return t?{model:r,value:t}:null},o.get.rgb=function(e){if(!e)return null;var t,r,n,i=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(n=t[2],t=t[1],r=0;r<3;r++){var o=2*r;i[r]=parseInt(t.slice(o,2+o),16)}n&&(i[3]=parseInt(n,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(n=(t=t[1])[3],r=0;r<3;r++)i[r]=parseInt(t[r]+t[r],16);n&&(i[3]=parseInt(n+n,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(r=0;r<3;r++)i[r]=parseInt(t[r+1],0);t[4]&&(t[5]?i[3]=.01*parseFloat(t[4]):i[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:s.call(a,t[1])?((i=a[t[1]])[3]=1,i):null:null;for(r=0;r<3;r++)i[r]=Math.round(2.55*parseFloat(t[r+1]));t[4]&&(t[5]?i[3]=.01*parseFloat(t[4]):i[3]=parseFloat(t[4]))}for(r=0;r<3;r++)i[r]=l(i[r],0,255);return i[3]=l(i[3],0,1),i},o.get.hsl=function(e){if(!e)return null;var t,e=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);return e?(t=parseFloat(e[4]),[(parseFloat(e[1])%360+360)%360,l(parseFloat(e[2]),0,100),l(parseFloat(e[3]),0,100),l(isNaN(t)?1:t,0,1)]):null},o.get.hwb=function(e){if(!e)return null;var t,e=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);return e?(t=parseFloat(e[4]),[(parseFloat(e[1])%360+360)%360,l(parseFloat(e[2]),0,100),l(parseFloat(e[3]),0,100),l(isNaN(t)?1:t,0,1)]):null},o.to.hex=function(){var e=i(arguments);return"#"+u(e[0])+u(e[1])+u(e[2])+(e[3]<1?u(Math.round(255*e[3])):"")},o.to.rgb=function(){var e=i(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},o.to.rgb.percent=function(){var e=i(arguments),t=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+r+"%, "+n+"%)":"rgba("+t+"%, "+r+"%, "+n+"%, "+e[3]+")"},o.to.hsl=function(){var e=i(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},o.to.hwb=function(){var e=i(arguments),t="";return 4<=e.length&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},o.to.keyword=function(e){return n[e.slice(0,3)]}},{"color-name":26,"simple-swizzle":38}],28:[function(e,n,i){"use strict";var l=e("color-string"),u=e("color-convert"),c=[].slice,m=["keyword","gray","hex"],f={},d=(Object.keys(u).forEach(function(e){f[c.call(u[e].labels).sort().join("")]=e}),{});function h(e,t){if(!(this instanceof h))return new h(e,t);if((t=t&&t in m?null:t)&&!(t in u))throw new Error("Unknown model: "+t);if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof h)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var r=l.get(e);if(null===r)throw new Error("Unable to parse color from string: "+e);this.model=r.model,n=u[this.model].channels,this.color=r.value.slice(0,n),this.valpha="number"==typeof r.value[n]?r.value[n]:1}else if(e.length){this.model=t||"rgb";var n=u[this.model].channels,r=c.call(e,0,n);this.color=p(r,n),this.valpha="number"==typeof e[n]?e[n]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;t=Object.keys(e),r=("alpha"in e&&(t.splice(t.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0),t.sort().join(""));if(!(r in f))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=f[r];for(var i=u[this.model].labels,o=[],a=0;a<i.length;a++)o.push(e[i[a]]);this.color=p(o)}if(d[this.model])for(n=u[this.model].channels,a=0;a<n;a++){var s=d[this.model][a];s&&(this.color[a]=s(this.color[a]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function t(r,n,i){return(r=Array.isArray(r)?r:[r]).forEach(function(e){(d[e]||(d[e]=[]))[n]=i}),r=r[0],function(e){var t;return arguments.length?(i&&(e=i(e)),(t=this[r]()).color[n]=e,t):(t=this[r]().color[n],i?i(t):t)}}function r(t){return function(e){return Math.max(0,Math.min(t,e))}}function p(e,t){for(var r=0;r<t;r++)"number"!=typeof e[r]&&(e[r]=0);return e}h.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in l.to?this:this.rgb(),e=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return l.to[t.model](e)},percentString:function(e){e=this.rgb().round("number"==typeof e?e:1),e=1===e.valpha?e.color:e.color.concat(this.valpha);return l.to.rgb.percent(e)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=u[this.model].channels,r=u[this.model].labels,n=0;n<t;n++)e[r[n]]=this.color[n];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new h(this.color.map((t=e,function(e){return Number(e.toFixed(t))})).concat(this.valpha),this.model);var t},alpha:function(e){return arguments.length?new h(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:t("rgb",0,r(255)),green:t("rgb",1,r(255)),blue:t("rgb",2,r(255)),hue:t(["hsl","hsv","hsl","hwb","hcg"],0,function(e){return(e%360+360)%360}),saturationl:t("hsl",1,r(100)),lightness:t("hsl",2,r(100)),saturationv:t("hsv",1,r(100)),value:t("hsv",2,r(100)),chroma:t("hcg",1,r(100)),gray:t("hcg",2,r(100)),white:t("hwb",1,r(100)),wblack:t("hwb",2,r(100)),cyan:t("cmyk",0,r(100)),magenta:t("cmyk",1,r(100)),yellow:t("cmyk",2,r(100)),black:t("cmyk",3,r(100)),x:t("xyz",0,r(100)),y:t("xyz",1,r(100)),z:t("xyz",2,r(100)),l:t("lab",0,r(100)),a:t("lab",1),b:t("lab",2),keyword:function(e){return arguments.length?new h(e):u[this.model].keyword(this.color)},hex:function(e){return arguments.length?new h(e):l.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],r=0;r<e.length;r++){var n=e[r]/255;t[r]=n<=.03928?n/12.92:Math.pow((.055+n)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),e=e.luminosity();return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)},level:function(e){e=this.contrast(e);return 7.1<=e?"AAA":4.5<=e?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,e=.3*e[0]+.59*e[1]+.11*e[2];return h.rgb(e,e,e)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),r=((r=t.color[0])+e)%360;return t.color[0]=r=r<0?360+r:r,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var e=e.rgb(),r=this.rgb(),t=void 0===t?.5:t,n=2*t-1,i=e.alpha()-r.alpha(),n=(1+(n*i==-1?n:(n+i)/(1+n*i)))/2,i=1-n;return h.rgb(n*e.red()+i*r.red(),n*e.green()+i*r.green(),n*e.blue()+i*r.blue(),e.alpha()*t+r.alpha()*(1-t))}},Object.keys(u).forEach(function(r){var n;-1===m.indexOf(r)&&(n=u[r].channels,h.prototype[r]=function(){if(this.model===r)return new h(this);if(arguments.length)return new h(arguments,r);var e,t="number"==typeof arguments[n]?n:this.valpha;return new h((e=u[this.model][r].raw(this.color),(Array.isArray(e)?e:[e]).concat(t)),r)},h[r]=function(e){return new h(e="number"==typeof e?p(c.call(arguments),n):e,r)})}),n.exports=h},{"color-convert":24,"color-string":27}],29:[function(e,t,r){!function(i){!function(){t.exports=class{constructor(e=100){this.size=e,this.length=0,this.buf=i.alloc(e)}prepend(e){if(i.isBuffer(e)){var t=this.length+e.length;if(t>=this.size&&(this.resize(),t>=this.size))throw Error("INVALID_BUFFER_STATE");const r=this.buf;this.buf=i.alloc(this.size),e.copy(this.buf,0),r.copy(this.buf,e.length),this.length+=e.length}else{t=this.length++;t===this.size&&this.resize();const n=this.clone();this.buf[0]=e,n.copy(this.buf,1,0,t)}}append(e){var t=this.length++;t===this.size&&this.resize(),this.buf[t]=e}clone(){return i.from(this.buf.slice(0,this.length))}resize(){var e=this.length,t=(this.size=2*this.size,i.alloc(this.size));this.buf.copy(t,0,0,e),this.buf=t}toString(e){return e?this.buf.slice(0,this.length).toString(e):Uint8Array.prototype.slice.call(this.buf.slice(0,this.length))}toJSON(){return this.toString("utf8")}reset(){this.length=0}}}.call(this)}.call(this,e("buffer").Buffer)},{buffer:22}],30:[function(r,n,e){!function(L,f){!function(){var e=r("stream")["Transform"];const a=r("./ResizeableBuffer"),x={utf8:L.from([239,187,191]),utf16le:L.from([255,254])};class l extends e{constructor(e={}){super({readableObjectMode:!0,...e,encoding:null}),this.__originalOptions=e,this.__normalizeOptions(e)}__normalizeOptions(e){const t={};for(var r in e)t[s(r)]=e[r];if(void 0===t.encoding||!0===t.encoding)t.encoding="utf8";else if(null===t.encoding||!1===t.encoding)t.encoding=null;else if("string"!=typeof t.encoding&&null!==t.encoding)throw new D("CSV_INVALID_OPTION_ENCODING",["Invalid option encoding:","encoding must be a string or null to return a buffer,","got "+JSON.stringify(t.encoding)],t);if(void 0===t.bom||null===t.bom||!1===t.bom)t.bom=!1;else if(!0!==t.bom)throw new D("CSV_INVALID_OPTION_BOM",["Invalid option bom:","bom must be true,","got "+JSON.stringify(t.bom)],t);let n=null;if(void 0===t.cast||null===t.cast||!1===t.cast||""===t.cast)t.cast=void 0;else if("function"==typeof t.cast)n=t.cast,t.cast=!0;else if(!0!==t.cast)throw new D("CSV_INVALID_OPTION_CAST",["Invalid option cast:","cast must be true or a function,","got "+JSON.stringify(t.cast)],t);if(void 0===t.cast_date||null===t.cast_date||!1===t.cast_date||""===t.cast_date)t.cast_date=!1;else{if(!0!==t.cast_date)throw new D("CSV_INVALID_OPTION_CAST_DATE",["Invalid option cast_date:","cast_date must be true or a function,","got "+JSON.stringify(t.cast_date)],t);t.cast_date=function(e){var t=Date.parse(e);return isNaN(t)?e:new Date(t)}}let i=null;if(!0===t.columns)i=void 0;else if("function"==typeof t.columns)i=t.columns,t.columns=!0;else if(Array.isArray(t.columns))t.columns=c(t.columns);else{if(void 0!==t.columns&&null!==t.columns&&!1!==t.columns)throw new D("CSV_INVALID_OPTION_COLUMNS",["Invalid option columns:","expect an array, a function or true,","got "+JSON.stringify(t.columns)],t);t.columns=!1}if(void 0===t.columns_duplicates_to_array||null===t.columns_duplicates_to_array||!1===t.columns_duplicates_to_array)t.columns_duplicates_to_array=!1;else{if(!0!==t.columns_duplicates_to_array)throw new D("CSV_INVALID_OPTION_COLUMNS_DUPLICATES_TO_ARRAY",["Invalid option columns_duplicates_to_array:","expect an boolean,","got "+JSON.stringify(t.columns_duplicates_to_array)],t);if(!1===t.columns)throw new D("CSV_INVALID_OPTION_COLUMNS_DUPLICATES_TO_ARRAY",["Invalid option columns_duplicates_to_array:","the `columns` mode must be activated."],t)}if(void 0===t.comment||null===t.comment||!1===t.comment||""===t.comment)t.comment=null;else if("string"==typeof t.comment&&(t.comment=L.from(t.comment,t.encoding)),!L.isBuffer(t.comment))throw new D("CSV_INVALID_OPTION_COMMENT",["Invalid option comment:","comment must be a buffer or a string,","got "+JSON.stringify(t.comment)],t);const o=JSON.stringify(t.delimiter);if(Array.isArray(t.delimiter)||(t.delimiter=[t.delimiter]),0===t.delimiter.length)throw new D("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,","got "+o],t);if(t.delimiter=t.delimiter.map(function(e){if(null==e||!1===e)return L.from(",",t.encoding);if("string"==typeof e&&(e=L.from(e,t.encoding)),!L.isBuffer(e)||0===e.length)throw new D("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,","got "+o],t);return e}),void 0===t.escape||!0===t.escape?t.escape=L.from('"',t.encoding):"string"==typeof t.escape?t.escape=L.from(t.escape,t.encoding):null!==t.escape&&!1!==t.escape||(t.escape=null),null!==t.escape&&!L.isBuffer(t.escape))throw new Error("Invalid Option: escape must be a buffer, a string or a boolean, got "+JSON.stringify(t.escape));if(void 0===t.from||null===t.from)t.from=1;else{if("string"==typeof t.from&&/\d+/.test(t.from)&&(t.from=parseInt(t.from)),!Number.isInteger(t.from))throw new Error("Invalid Option: from must be an integer, got "+JSON.stringify(t.from));if(t.from<0)throw new Error("Invalid Option: from must be a positive integer, got "+JSON.stringify(e.from))}if(void 0===t.from_line||null===t.from_line)t.from_line=1;else{if("string"==typeof t.from_line&&/\d+/.test(t.from_line)&&(t.from_line=parseInt(t.from_line)),!Number.isInteger(t.from_line))throw new Error("Invalid Option: from_line must be an integer, got "+JSON.stringify(e.from_line));if(t.from_line<=0)throw new Error("Invalid Option: from_line must be a positive integer greater than 0, got "+JSON.stringify(e.from_line))}if(void 0===t.ignore_last_delimiters||null===t.ignore_last_delimiters)t.ignore_last_delimiters=!1;else if("number"==typeof t.ignore_last_delimiters)t.ignore_last_delimiters=Math.floor(t.ignore_last_delimiters),0===t.ignore_last_delimiters&&(t.ignore_last_delimiters=!1);else if("boolean"!=typeof t.ignore_last_delimiters)throw new D("CSV_INVALID_OPTION_IGNORE_LAST_DELIMITERS",["Invalid option `ignore_last_delimiters`:","the value must be a boolean value or an integer,","got "+JSON.stringify(t.ignore_last_delimiters)],t);if(!0===t.ignore_last_delimiters&&!1===t.columns)throw new D("CSV_IGNORE_LAST_DELIMITERS_REQUIRES_COLUMNS",["The option `ignore_last_delimiters`","requires the activation of the `columns` option"],t);if(void 0===t.info||null===t.info||!1===t.info)t.info=!1;else if(!0!==t.info)throw new Error("Invalid Option: info must be true, got "+JSON.stringify(t.info));if(void 0===t.max_record_size||null===t.max_record_size||!1===t.max_record_size)t.max_record_size=0;else if(!(Number.isInteger(t.max_record_size)&&0<=t.max_record_size)){if("string"!=typeof t.max_record_size||!/\d+/.test(t.max_record_size))throw new Error("Invalid Option: max_record_size must be a positive integer, got "+JSON.stringify(t.max_record_size));t.max_record_size=parseInt(t.max_record_size)}if(void 0===t.objname||null===t.objname||!1===t.objname)t.objname=void 0;else if(L.isBuffer(t.objname)){if(0===t.objname.length)throw new Error("Invalid Option: objname must be a non empty buffer");null===t.encoding||(t.objname=t.objname.toString(t.encoding))}else{if("string"!=typeof t.objname)throw new Error("Invalid Option: objname must be a string or a buffer, got "+t.objname);if(0===t.objname.length)throw new Error("Invalid Option: objname must be a non empty string")}if(void 0===t.on_record||null===t.on_record)t.on_record=void 0;else if("function"!=typeof t.on_record)throw new D("CSV_INVALID_OPTION_ON_RECORD",["Invalid option `on_record`:","expect a function,","got "+JSON.stringify(t.on_record)],t);if(null===t.quote||!1===t.quote||""===t.quote)t.quote=null;else if(void 0===t.quote||!0===t.quote?t.quote=L.from('"',t.encoding):"string"==typeof t.quote&&(t.quote=L.from(t.quote,t.encoding)),!L.isBuffer(t.quote))throw new Error("Invalid Option: quote must be a buffer or a string, got "+JSON.stringify(t.quote));if(void 0===t.raw||null===t.raw||!1===t.raw)t.raw=!1;else if(!0!==t.raw)throw new Error("Invalid Option: raw must be true, got "+JSON.stringify(t.raw));if(t.record_delimiter?Array.isArray(t.record_delimiter)||(t.record_delimiter=[t.record_delimiter]):t.record_delimiter=[],t.record_delimiter=t.record_delimiter.map(function(e){return e="string"==typeof e?L.from(e,t.encoding):e}),"boolean"!=typeof t.relax){if(void 0!==t.relax&&null!==t.relax)throw new Error("Invalid Option: relax must be a boolean, got "+JSON.stringify(t.relax));t.relax=!1}if("boolean"!=typeof t.relax_column_count){if(void 0!==t.relax_column_count&&null!==t.relax_column_count)throw new Error("Invalid Option: relax_column_count must be a boolean, got "+JSON.stringify(t.relax_column_count));t.relax_column_count=!1}if("boolean"!=typeof t.relax_column_count_less){if(void 0!==t.relax_column_count_less&&null!==t.relax_column_count_less)throw new Error("Invalid Option: relax_column_count_less must be a boolean, got "+JSON.stringify(t.relax_column_count_less));t.relax_column_count_less=!1}if("boolean"!=typeof t.relax_column_count_more){if(void 0!==t.relax_column_count_more&&null!==t.relax_column_count_more)throw new Error("Invalid Option: relax_column_count_more must be a boolean, got "+JSON.stringify(t.relax_column_count_more));t.relax_column_count_more=!1}if("boolean"!=typeof t.skip_empty_lines){if(void 0!==t.skip_empty_lines&&null!==t.skip_empty_lines)throw new Error("Invalid Option: skip_empty_lines must be a boolean, got "+JSON.stringify(t.skip_empty_lines));t.skip_empty_lines=!1}if("boolean"!=typeof t.skip_lines_with_empty_values){if(void 0!==t.skip_lines_with_empty_values&&null!==t.skip_lines_with_empty_values)throw new Error("Invalid Option: skip_lines_with_empty_values must be a boolean, got "+JSON.stringify(t.skip_lines_with_empty_values));t.skip_lines_with_empty_values=!1}if("boolean"!=typeof t.skip_lines_with_error){if(void 0!==t.skip_lines_with_error&&null!==t.skip_lines_with_error)throw new Error("Invalid Option: skip_lines_with_error must be a boolean, got "+JSON.stringify(t.skip_lines_with_error));t.skip_lines_with_error=!1}if(void 0===t.rtrim||null===t.rtrim||!1===t.rtrim)t.rtrim=!1;else if(!0!==t.rtrim)throw new Error("Invalid Option: rtrim must be a boolean, got "+JSON.stringify(t.rtrim));if(void 0===t.ltrim||null===t.ltrim||!1===t.ltrim)t.ltrim=!1;else if(!0!==t.ltrim)throw new Error("Invalid Option: ltrim must be a boolean, got "+JSON.stringify(t.ltrim));if(void 0===t.trim||null===t.trim||!1===t.trim)t.trim=!1;else if(!0!==t.trim)throw new Error("Invalid Option: trim must be a boolean, got "+JSON.stringify(t.trim));if(!0===t.trim&&!1!==e.ltrim?t.ltrim=!0:!0!==t.ltrim&&(t.ltrim=!1),!0===t.trim&&!1!==e.rtrim?t.rtrim=!0:!0!==t.rtrim&&(t.rtrim=!1),void 0===t.to||null===t.to)t.to=-1;else{if("string"==typeof t.to&&/\d+/.test(t.to)&&(t.to=parseInt(t.to)),!Number.isInteger(t.to))throw new Error("Invalid Option: to must be an integer, got "+JSON.stringify(e.to));if(t.to<=0)throw new Error("Invalid Option: to must be a positive integer greater than 0, got "+JSON.stringify(e.to))}if(void 0===t.to_line||null===t.to_line)t.to_line=-1;else{if("string"==typeof t.to_line&&/\d+/.test(t.to_line)&&(t.to_line=parseInt(t.to_line)),!Number.isInteger(t.to_line))throw new Error("Invalid Option: to_line must be an integer, got "+JSON.stringify(e.to_line));if(t.to_line<=0)throw new Error("Invalid Option: to_line must be a positive integer greater than 0, got "+JSON.stringify(e.to_line))}this.info={bytes:0,comment_lines:0,empty_lines:0,invalid_field_length:0,lines:1,records:0},this.options=t,this.state={bomSkipped:!1,bufBytesStart:0,castField:n,commenting:!1,error:void 0,enabled:1===t.from_line,escaping:!1,escapeIsQuote:L.isBuffer(t.escape)&&L.isBuffer(t.quote)&&0===L.compare(t.escape,t.quote),expectedRecordLength:Array.isArray(t.columns)?t.columns.length:void 0,field:new a(20),firstLineToHeaders:i,needMoreDataSize:Math.max(null!==t.comment?t.comment.length:0,...t.delimiter.map(e=>e.length),null!==t.quote?t.quote.length:0),previousBuf:void 0,quoting:!1,stop:!1,rawBuffer:new a(100),record:[],recordHasError:!1,record_length:0,recordDelimiterMaxLength:0===t.record_delimiter.length?2:Math.max(...t.record_delimiter.map(e=>e.length)),trimChars:[L.from(" ",t.encoding)[0],L.from("\t",t.encoding)[0]],wasQuoting:!1,wasRowDelimiter:!1}}_transform(e,t,r){!0!==this.state.stop&&(void 0!==(e=this.__parse(e,!1))&&(this.state.stop=!0),r(e))}_flush(e){!0!==this.state.stop&&e(this.__parse(void 0,!0))}__parse(e,c){var{bom:f,comment:d,escape:t,from_line:h,ltrim:p,max_record_size:m,quote:r,raw:g,relax:y,rtrim:b,skip_empty_lines:v,to:_,to_line:w}=this.options;let M=this.options["record_delimiter"];const{bomSkipped:E,previousBuf:S,rawBuffer:C,escapeIsQuote:N}=this.state;let n;if(void 0===S){if(void 0===e)return void this.push(null);n=e}else n=void 0!==S&&void 0===e?S:L.concat([S,e]);if(!1===E)if(!1===f)this.state.bomSkipped=!0;else if(n.length<3){if(!1===c)return void(this.state.previousBuf=n)}else{for(var T in x)if(0===x[T].compare(n,0,x[T].length)){var I=x[T].length;this.state.bufBytesStart+=I,n=n.slice(I),this.__normalizeOptions({...this.__originalOptions,encoding:T});break}this.state.bomSkipped=!0}var k=n.length;let i;for(i=0;i<k&&!this.__needMoreData(i,k,c);i++){if(!0===this.state.wasRowDelimiter&&(this.info.lines++,this.state.wasRowDelimiter=!1),-1!==w&&this.info.lines>w)return this.state.stop=!0,void this.push(null);!1===this.state.quoting&&0===M.length&&this.__autoDiscoverRecordDelimiter(n,i)&&(M=this.options.record_delimiter);var o=n[i];if(!0===g&&C.append(o),13!==o&&10!==o||!1!==this.state.wasRowDelimiter||(this.state.wasRowDelimiter=!0),!0===this.state.escaping)this.state.escaping=!1;else{if(null!==t&&!0===this.state.quoting&&this.__isEscape(n,i,o)&&i+t.length<k){if(!N){this.state.escaping=!0,i+=t.length-1;continue}if(this.__isQuote(n,i+t.length)){this.state.escaping=!0,i+=t.length-1;continue}}if(!1===this.state.commenting&&this.__isQuote(n,i))if(!0===this.state.quoting){var a=n[i+r.length],A=b&&this.__isCharTrimable(a),s=null!==d&&this.__compareBytes(d,n,i+r.length,a),l=this.__isDelimiter(n,i+r.length,a),O=0===M.length?this.__autoDiscoverRecordDelimiter(n,i+r.length):this.__isRecordDelimiter(a,n,i+r.length);if(null!==t&&this.__isEscape(n,i,o)&&this.__isQuote(n,i+t.length))i+=t.length-1;else{if(!a||l||O||s||A){this.state.quoting=!1,this.state.wasQuoting=!0,i+=r.length-1;continue}if(!1===y){l=this.__error(new D("CSV_INVALID_CLOSING_QUOTE",["Invalid Closing Quote:",`got "${String.fromCharCode(a)}"`,"at line "+this.info.lines,"instead of delimiter, record delimiter, trimable character","(if activated) or comment"],this.options,this.__infoField()));if(void 0!==l)return l}else this.state.quoting=!1,this.state.wasQuoting=!0,this.state.field.prepend(r),i+=r.length-1}}else{if(0===this.state.field.length){this.state.quoting=!0,i+=r.length-1;continue}if(!1===y){O=this.__error(new D("INVALID_OPENING_QUOTE",["Invalid Opening Quote:","a quote is found inside a field at line "+this.info.lines],this.options,this.__infoField(),{field:this.state.field}));if(void 0!==O)return O}}if(!1===this.state.quoting){s=this.__isRecordDelimiter(o,n,i);if(0!==s){if(this.state.commenting&&!1===this.state.wasQuoting&&0===this.state.record.length&&0===this.state.field.length)this.info.comment_lines++;else{if(!1===this.state.enabled&&this.info.lines+(!0===this.state.wasRowDelimiter?1:0)>=h){this.state.enabled=!0,this.__resetField(),this.__resetRecord(),i+=s-1;continue}if(!0===v&&!1===this.state.wasQuoting&&0===this.state.record.length&&0===this.state.field.length){this.info.empty_lines++,i+=s-1;continue}this.info.bytes=this.state.bufBytesStart+i;A=this.__onField();if(void 0!==A)return A;this.info.bytes=this.state.bufBytesStart+i+s;a=this.__onRecord();if(void 0!==a)return a;if(-1!==_&&this.info.records>=_)return this.state.stop=!0,void this.push(null)}this.state.commenting=!1,i+=s-1;continue}if(this.state.commenting)continue;if(0!==(null===d?0:this.__compareBytes(d,n,i,o))){this.state.commenting=!0;continue}l=this.__isDelimiter(n,i,o);if(0!==l){this.info.bytes=this.state.bufBytesStart+i;var u=this.__onField();if(void 0!==u)return u;i+=l-1;continue}}}if(!1===this.state.commenting&&0!==m&&this.state.record_length+this.state.field.length>m){u=this.__error(new D("CSV_MAX_RECORD_SIZE",["Max Record Size:","record exceed the maximum number of tolerated bytes","of "+m,"at line "+this.info.lines],this.options,this.__infoField()));if(void 0!==u)return u}var R=!1===p||!0===this.state.quoting||0!==this.state.field.length||!this.__isCharTrimable(o),P=!1===b||!1===this.state.wasQuoting;if(!0==R&&!0==P)this.state.field.append(o);else if(!0===b&&!this.__isCharTrimable(o)){R=this.__error(new D("CSV_NON_TRIMABLE_CHAR_AFTER_CLOSING_QUOTE",["Invalid Closing Quote:","found non trimable byte after quote","at line "+this.info.lines],this.options,this.__infoField()));if(void 0!==R)return R}}if(!0===c)if(!0===this.state.quoting){e=this.__error(new D("CSV_QUOTE_NOT_CLOSED",["Quote Not Closed:","the parsing is finished with an opening quote at line "+this.info.lines],this.options,this.__infoField()));if(void 0!==e)return e}else if(!0===this.state.wasQuoting||0!==this.state.record.length||0!==this.state.field.length){this.info.bytes=this.state.bufBytesStart+i;f=this.__onField();if(void 0!==f)return f;e=this.__onRecord();if(void 0!==e)return e}else!0===this.state.wasRowDelimiter?this.info.empty_lines++:!0===this.state.commenting&&this.info.comment_lines++;else this.state.bufBytesStart+=i,this.state.previousBuf=n.slice(i);!0===this.state.wasRowDelimiter&&(this.info.lines++,this.state.wasRowDelimiter=!1)}__onRecord(){var{columns:r,columns_duplicates_to_array:c,encoding:f,info:e,from:t,relax_column_count:n,relax_column_count_less:i,relax_column_count_more:d,raw:o,skip_lines_with_empty_values:a}=this.options,{enabled:s,record:l}=this.state;if(!1===s)return this.__resetRecord();s=l.length;if(!0===r)return!0===a&&p(l)?void this.__resetRecord():this.__firstLineToColumns(l);if(!1===r&&0===this.info.records&&(this.state.expectedRecordLength=s),s!==this.state.expectedRecordLength){var h=!1===r?new D("CSV_INCONSISTENT_RECORD_LENGTH",["Invalid Record Length:",`expect ${this.state.expectedRecordLength},`,`got ${s} on line `+this.info.lines],this.options,this.__infoField(),{record:l}):new D("CSV_RECORD_DONT_MATCH_COLUMNS_LENGTH",["Invalid Record Length:",`columns length is ${r.length},`,`got ${s} on line `+this.info.lines],this.options,this.__infoField(),{record:l});if(!0===n||!0===i&&s<this.state.expectedRecordLength||!0===d&&s>this.state.expectedRecordLength)this.info.invalid_field_length++,this.state.error=h;else{n=this.__error(h);if(n)return n}}if(!0===a&&p(l))this.__resetRecord();else{if(!0===this.state.recordHasError)return this.__resetRecord(),void(this.state.recordHasError=!1);if(this.info.records++,1===t||this.info.records>=t)if(!1!==r){const u={};for(let e=0,t=l.length;e<t;e++)void 0===r[e]||r[e].disabled||(!0===c&&void 0!==u[r[e].name]?Array.isArray(u[r[e].name])?u[r[e].name]=u[r[e].name].concat(l[e]):u[r[e].name]=[u[r[e].name],l[e]]:u[r[e].name]=l[e]);i=this.options["objname"];if(void 0===i)if(!0===o||!0===e){d=this.__push(Object.assign({record:u},!0===o?{raw:this.state.rawBuffer.toString(f)}:{},!0===e?{info:this.__infoRecord()}:{}));if(d)return d}else{s=this.__push(u);if(s)return s}else if(!0===o||!0===e){h=this.__push(Object.assign({record:[u[i],u]},!0===o?{raw:this.state.rawBuffer.toString(f)}:{},!0===e?{info:this.__infoRecord()}:{}));if(h)return h}else{n=this.__push([u[i],u]);if(n)return n}}else if(!0===o||!0===e){a=this.__push(Object.assign({record:l},!0===o?{raw:this.state.rawBuffer.toString(f)}:{},!0===e?{info:this.__infoRecord()}:{}));if(a)return a}else{t=this.__push(l);if(t)return t}this.__resetRecord()}}__firstLineToColumns(e){const t=this.state["firstLineToHeaders"];try{var r=void 0===t?e:t.call(null,e);if(!Array.isArray(r))return this.__error(new D("CSV_INVALID_COLUMN_MAPPING",["Invalid Column Mapping:","expect an array from column function,","got "+JSON.stringify(r)],this.options,this.__infoField(),{headers:r}));var n=c(r);return this.state.expectedRecordLength=n.length,this.options.columns=n,void this.__resetRecord()}catch(e){return e}}__resetRecord(){!0===this.options.raw&&this.state.rawBuffer.reset(),this.state.error=void 0,this.state.record=[],this.state.record_length=0}__onField(){var{cast:e,encoding:t,rtrim:r,max_record_size:n}=this.options,{enabled:i,wasQuoting:o}=this.state;if(!1===i)return this.__resetField();let a=this.state.field.toString(t);if(!0===r&&!1===o&&(a=a.trimRight()),!0===e){var[i,t]=this.__cast(a);if(void 0!==i)return i;a=t}this.state.record.push(a),0!==n&&"string"==typeof a&&(this.state.record_length+=a.length),this.__resetField()}__resetField(){this.state.field.reset(),this.state.wasQuoting=!1}__push(e){const t=this.options["on_record"];if(void 0!==t){var r=this.__infoRecord();try{e=t.call(null,e,r)}catch(e){return e}if(null==e)return}this.push(e)}__cast(e){var{columns:t,relax_column_count:r}=this.options;if(!0===Array.isArray(t)&&r&&this.options.columns.length<=this.state.record.length)return[void 0,void 0];if(null!==this.state.castField)try{var n=this.__infoField();return[void 0,this.state.castField.call(null,e,n)]}catch(e){return[e]}return this.__isFloat(e)?[void 0,parseFloat(e)]:!1!==this.options.cast_date?(t=this.__infoField(),[void 0,this.options.cast_date.call(null,e,t)]):[void 0,e]}__isCharTrimable(e){return 32===e||9===e||13===e||10===e||12===e}__isFloat(e){return 0<=e-parseFloat(e)+1}__compareBytes(t,r,n,e){if(t[0]!==e)return 0;var i=t.length;for(let e=1;e<i;e++)if(t[e]!==r[n+e])return 0;return i}__needMoreData(e,t,r){if(r)return!1;var r=this.options["quote"],{quoting:n,needMoreDataSize:i,recordDelimiterMaxLength:o}=this.state;return t-e-1<Math.max(i,o,n?r.length+o:0)}__isDelimiter(t,r,n){var{delimiter:i,ignore_last_delimiters:e}=this.options;if(!0===e&&this.state.record.length===this.options.columns.length-1)return 0;if(!1!==e&&"number"==typeof e&&this.state.record.length===e-1)return 0;e:for(let e=0;e<i.length;e++){var o=i[e];if(o[0]===n){for(let e=1;e<o.length;e++)if(o[e]!==t[r+e])continue e;return o.length}}return 0}__isRecordDelimiter(t,r,n){var i=this.options["record_delimiter"],o=i.length;e:for(let e=0;e<o;e++){var a=i[e],s=a.length;if(a[0]===t){for(let e=1;e<s;e++)if(a[e]!==r[n+e])continue e;return a.length}}return 0}__isEscape(t,r,e){var n=this.options["escape"];if(null===n)return!1;var i=n.length;if(n[0]!==e)return!1;for(let e=0;e<i;e++)if(n[e]!==t[r+e])return!1;return!0}__isQuote(t,r){var n=this.options["quote"];if(null===n)return!1;var i=n.length;for(let e=0;e<i;e++)if(n[e]!==t[r+e])return!1;return!0}__autoDiscoverRecordDelimiter(e,t){var r=this.options["encoding"],n=e[t];return 13===n?10===e[t+1]?(this.options.record_delimiter.push(L.from("\r\n",r)),this.state.recordDelimiterMaxLength=2):(this.options.record_delimiter.push(L.from("\r",r)),this.state.recordDelimiterMaxLength=1):10===n?(this.options.record_delimiter.push(L.from("\n",r)),this.state.recordDelimiterMaxLength=1):0}__error(e){var t=this.options["skip_lines_with_error"],e="string"==typeof e?new Error(e):e;if(!t)return e;this.state.recordHasError=!0,this.emit("skip",e)}__infoDataSet(){return{...this.info,columns:this.options.columns}}__infoRecord(){var e=this.options["columns"];return{...this.__infoDataSet(),error:this.state.error,header:!0===e,index:this.state.record.length}}__infoField(){var e=this.options["columns"],t=Array.isArray(e);return{...this.__infoRecord(),column:!0===t?e.length>this.state.record.length?e[this.state.record.length].name:null:this.state.record.length,quoting:this.state.wasQuoting}}}function t(){let e,t,r;for(var n in arguments){var i=arguments[n],o=typeof i;if(void 0!==e||"string"!=typeof i&&!L.isBuffer(i))if(void 0===t&&u(i))t=i;else{if(void 0!==r||"function"!=o)throw new D("CSV_INVALID_ARGUMENT",["Invalid argument:",`got ${JSON.stringify(i)} at index `+n],t||{});r=i}else e=i}const a=new l(t);if(r){const s=void 0===t||void 0===t.objname?[]:{};a.on("readable",function(){for(var e;null!==(e=this.read());)void 0===t||void 0===t.objname?s.push(e):s[e[0]]=e[1]}),a.on("error",function(e){r(e,void 0,a.__infoDataSet())}),a.on("end",function(){r(void 0,s,a.__infoDataSet())})}return void 0!==e&&("function"==typeof f?f(function(){a.write(e),a.end()}):(a.write(e),a.end())),a}class D extends Error{constructor(e,t,r,...n){super(t=Array.isArray(t)?t.join(" "):t),void 0!==Error.captureStackTrace&&Error.captureStackTrace(this,D),this.code=e;for(const i of n)for(const o in i){const a=i[o];this[o]=L.isBuffer(a)?a.toString(r.encoding):null==a?a:JSON.parse(JSON.stringify(a))}}}t.Parser=l,t.CsvError=D,n.exports=t;const s=function(e){return e.replace(/([A-Z])/g,function(e,t){return"_"+t.toLowerCase()})},u=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)},p=function(e){return e.every(e=>null==e||e.toString&&""===e.toString().trim())},c=function(r){const n=[];for(let e=0,t=r.length;e<t;e++){var i=r[e];if(null==i||!1===i)n[e]={disabled:!0};else if("string"==typeof i)n[e]={name:i};else{if(!u(i))throw new D("CSV_INVALID_COLUMN_DEFINITION",["Invalid column definition:","expect a string or a literal object,",`got ${JSON.stringify(i)} at position `+e]);if("string"!=typeof i.name)throw new D("CSV_OPTION_COLUMNS_MISSING_NAME",["Option columns missing name:",'property "name" is required at position '+e,"when column is an object literal"]);n[e]=i}}return n}}.call(this)}.call(this,r("buffer").Buffer,r("timers").setImmediate)},{"./ResizeableBuffer":29,buffer:22,stream:40,timers:56}],31:[function(e,t,r){!function(o){!function(){const i=e(".");t.exports=function(e,t={}){"string"==typeof e&&(e=o.from(e));const r=t&&t.objname?{}:[],n=new i.Parser(t);n.push=function(e){null!==e&&(void 0===t.objname?r.push(e):r[e[0]]=e[1])};e=n.__parse(e,!1);if(void 0!==e)throw e;e=n.__parse(void 0,!0);if(void 0!==e)throw e;return r}}.call(this)}.call(this,e("buffer").Buffer)},{".":30,buffer:22}],32:[function(c,e,f){"use strict";var t="object"==typeof Reflect?Reflect:null,l=t&&"function"==typeof t.apply?t.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};var d=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},r=Number.isNaN||function(e){return e!=e};function n(){n.init.call(this)}e.exports=n,e.exports.once=function(s,l){return new Promise(function(e,t){function r(e){s.removeListener(l,n),t(e)}function n(){"function"==typeof s.removeListener&&s.removeListener("error",r),e([].slice.call(arguments))}var i,o,a;g(s,l,n,{once:!0}),"error"!==l&&(o=r,a={once:!0},"function"==typeof(i=s).on&&g(i,"error",o,a))})},(n.EventEmitter=n).prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var i=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function a(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function o(e,t,r,n){var i,o;return u(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener||r),i=e._events),o=i[t]),void 0===o?(o=i[t]=r,++e._eventsCount):("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),0<(i=a(e))&&o.length>i&&!o.warned&&(o.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=e,n.type=t,n.count=o.length,r=n,console&&console.warn&&console.warn(r))),e}function s(e,t,r){e={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},t=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(e);return t.listener=r,e.wrapFn=t}function h(e,t,r){e=e._events;if(void 0===e)return[];e=e[t];{if(void 0===e)return[];if("function"==typeof e)return r?[e.listener||e]:[e];if(r){for(var n=e,i=new Array(n.length),o=0;o<i.length;++o)i[o]=n[o].listener||n[o];return i}return m(e,e.length)}}function p(e){var t=this._events;if(void 0!==t){t=t[e];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function m(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(r,n,i,o){if("function"==typeof r.on)o.once?r.once(n,i):r.on(n,i);else{if("function"!=typeof r.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r);r.addEventListener(n,function e(t){o.once&&r.removeEventListener(n,e),i(t)})}}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),n.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return a(this)},n.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){if((o=0<t.length?t[0]:o)instanceof Error)throw o;n=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw n.context=o,n}var o=i[e];if(void 0===o)return!1;if("function"==typeof o)l(o,this,t);else for(var a=o.length,s=m(o,a),r=0;r<a;++r)l(s[r],this,t);return!0},n.prototype.on=n.prototype.addListener=function(e,t){return o(this,e,t,!1)},n.prototype.prependListener=function(e,t){return o(this,e,t,!0)},n.prototype.once=function(e,t){return u(t),this.on(e,s(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,s(this,e,t)),this},n.prototype.off=n.prototype.removeListener=function(e,t){var r,n,i,o,a;if(u(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;0<=o;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;if(0===i)r.shift();else{for(var s=r,l=i;l+1<s.length;l++)s[l]=s[l+1];s.pop()}1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},n.prototype.removeAllListeners=function(e){var t,r=this._events;if(void 0===r)return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},n.prototype.listeners=function(e){return h(this,e,!0)},n.prototype.rawListeners=function(e){return h(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},n.prototype.listenerCount=p,n.prototype.eventNames=function(){return 0<this._eventsCount?d(this._events):[]}},{}],33:[function(e,t,r){r.read=function(e,t,r,n,i){var o,a,c=8*i-n-1,f=(1<<c)-1,d=f>>1,s=-7,l=r?i-1:0,u=r?-1:1,i=e[t+l];for(l+=u,o=i&(1<<-s)-1,i>>=-s,s+=c;0<s;o=256*o+e[t+l],l+=u,s-=8);for(a=o&(1<<-s)-1,o>>=-s,s+=n;0<s;a=256*a+e[t+l],l+=u,s-=8);if(0===o)o=1-d;else{if(o===f)return a?NaN:1/0*(i?-1:1);a+=Math.pow(2,n),o-=d}return(i?-1:1)*a*Math.pow(2,o-n)},r.write=function(e,t,c,r,n,f){var i,o,a=8*f-n-1,s=(1<<a)-1,l=s>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,u=r?0:f-1,h=r?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=s):(i=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-i))<1&&(i--,r*=2),2<=(t+=1<=i+l?d/r:d*Math.pow(2,1-l))*r&&(i++,r/=2),s<=i+l?(o=0,i=s):1<=i+l?(o=(t*r-1)*Math.pow(2,n),i+=l):(o=t*Math.pow(2,l-1)*Math.pow(2,n),i=0));8<=n;e[c+u]=255&o,u+=h,o/=256,n-=8);for(i=i<<n|o,a+=n;0<a;e[c+u]=255&i,u+=h,i/=256,a-=8);e[c+u-h]|=128*f}},{}],34:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){var r;t&&(e.super_=t,(r=function(){}).prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e)}},{}],35:[function(e,t,r){"use strict";var l=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},n)).join("")?void 0:1}catch(e){return}}()?Object.assign:function(e,t){for(var r,n=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),i=1;i<arguments.length;i++){for(var o in r=Object(arguments[i]))u.call(r,o)&&(n[o]=r[o]);if(l)for(var a=l(r),s=0;s<a.length;s++)c.call(r,a[s])&&(n[a[s]]=r[a[s]])}return n}},{}],36:[function(c,e,f){var r,n,e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}function d(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}var a,s=[],l=!1,u=-1;function h(){l&&a&&(l=!1,a.length?s=a.concat(s):u=-1,s.length&&p())}function p(){if(!l){for(var e=d(h),t=(l=!0,s.length);t;){for(a=s,s=[];++u<t;)a&&a[u].run();u=-1,t=s.length}a=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function t(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];s.push(new m(e,t)),1!==s.length||l||d(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=t,e.addListener=t,e.once=t,e.off=t,e.removeListener=t,e.removeAllListeners=t,e.emit=t,e.prependListener=t,e.prependOnceListener=t,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],37:[function(e,t,r){var n=e("buffer"),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(o(n,r),r.Buffer=a),o(i,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=i(e);return void 0!==t?"string"==typeof r?e.fill(t,r):e.fill(t):e.fill(0),e},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:22}],38:[function(e,t,r){"use strict";var o=e("is-arrayish"),a=Array.prototype.concat,s=Array.prototype.slice,n=t.exports=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];o(i)?t=a.call(t,s.call(i)):t.push(i)}return t};n.wrap=function(e){return function(){return e(n(arguments))}}},{"is-arrayish":39}],39:[function(e,t,r){t.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||0<=e.length&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},{}],40:[function(e,t,r){t.exports=n;var c=e("events").EventEmitter;function n(){c.call(this)}e("inherits")(n,c),n.Readable=e("readable-stream/lib/_stream_readable.js"),n.Writable=e("readable-stream/lib/_stream_writable.js"),n.Duplex=e("readable-stream/lib/_stream_duplex.js"),n.Transform=e("readable-stream/lib/_stream_transform.js"),n.PassThrough=e("readable-stream/lib/_stream_passthrough.js"),n.finished=e("readable-stream/lib/internal/streams/end-of-stream.js"),n.pipeline=e("readable-stream/lib/internal/streams/pipeline.js"),(n.Stream=n).prototype.pipe=function(t,e){var r=this;function n(e){t.writable&&!1===t.write(e)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),t.on("drain",i),t._isStdio||e&&!1===e.end||(r.on("end",a),r.on("close",s));var o=!1;function a(){o||(o=!0,t.end())}function s(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function l(e){if(u(),0===c.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",a),r.removeListener("close",s),r.removeListener("error",l),t.removeListener("error",l),r.removeListener("end",u),r.removeListener("close",u),t.removeListener("close",u)}return r.on("error",l),t.on("error",l),r.on("end",u),r.on("close",u),t.on("close",u),t.emit("pipe",r),t}},{events:32,inherits:34,"readable-stream/lib/_stream_duplex.js":42,"readable-stream/lib/_stream_passthrough.js":43,"readable-stream/lib/_stream_readable.js":44,"readable-stream/lib/_stream_transform.js":45,"readable-stream/lib/_stream_writable.js":46,"readable-stream/lib/internal/streams/end-of-stream.js":50,"readable-stream/lib/internal/streams/pipeline.js":52}],41:[function(e,t,r){"use strict";var n={};function i(e,i,t){var r=function(n){var e,t;function r(e,t,r){return n.call(this,(e=e,t=t,r=r,"string"==typeof i?i:i(e,t,r)))||this}return t=n,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t,r}(t=t||Error);r.prototype.name=t.name,r.prototype.code=e,n[e]=r}function l(e,t){var r;return Array.isArray(e)?(r=e.length,e=e.map(function(e){return String(e)}),2<r?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])):"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(e,t,r){var n,i,o,a,s;return"string"==typeof t&&(a="not ",t.substr(!o||o<0?0:+o,a.length)===a)?(n="must not be",t=t.replace(/^not /,"")):n="must be",o=e,a=" argument",(void 0===s||s>o.length)&&(s=o.length),o=o.substring(s-a.length,s)===a?"The ".concat(e," ").concat(n," ").concat(l(t,"type")):(s=(i="number"!=typeof i?0:i)+(o=".").length>(s=e).length||-1===s.indexOf(o,i)?"argument":"property",'The "'.concat(e,'" ').concat(s," ").concat(n," ").concat(l(t,"type"))),o+=". Received type ".concat(typeof r)},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n},{}],42:[function(c,f,e){!function(u){!function(){"use strict";var e=Object.keys||function(e){var t,r=[];for(t in e)r.push(t);return r},t=(f.exports=a,c("./_stream_readable")),r=c("./_stream_writable");c("inherits")(a,t);for(var n=e(r.prototype),i=0;i<n.length;i++){var o=n[i];a.prototype[o]||(a.prototype[o]=r.prototype[o])}function a(e){if(!(this instanceof a))return new a(e);t.call(this,e),r.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",s)))}function s(){this._writableState.ended||u.nextTick(l,this)}function l(e){e.end()}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}.call(this)}.call(this,c("_process"))},{"./_stream_readable":44,"./_stream_writable":46,_process:36,inherits:34}],43:[function(e,t,r){"use strict";t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":45,inherits:34}],44:[function(q,B,e){!function(j,F){!function(){"use strict";function g(e,t){return e.listeners(t).length}(B.exports=r).ReadableState=w,q("events").EventEmitter;var n,i=q("./internal/streams/stream"),c=q("buffer").Buffer,d=F.Uint8Array||function(){};var o,a,s,e=q("util"),p=e&&e.debuglog?e.debuglog("stream"):function(){},l=q("./internal/streams/buffer_list"),e=q("./internal/streams/destroy"),u=q("./internal/streams/state").getHighWaterMark,t=q("../errors").codes,h=t.ERR_INVALID_ARG_TYPE,y=t.ERR_STREAM_PUSH_AFTER_EOF,b=t.ERR_METHOD_NOT_IMPLEMENTED,v=t.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,m=(q("inherits")(r,i),e.errorOrDestroy),_=["error","close","destroy","pause","resume"];function w(e,t,r){n=n||q("./_stream_duplex"),"boolean"!=typeof r&&(r=t instanceof n),this.objectMode=!!(e=e||{}).objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=u(this,e,"readableHighWaterMark",r),this.buffer=new l,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(o=o||q("string_decoder/").StringDecoder,this.decoder=new o(e.encoding),this.encoding=e.encoding)}function r(e){if(n=n||q("./_stream_duplex"),!(this instanceof r))return new r(e);var t=this instanceof n;this._readableState=new w(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),i.call(this)}function M(e,t,r,n,i){p("readableAddChunk",t);var o,a,s,l,u=e._readableState;if(null===t)u.reading=!1,a=e,s=u,p("onEofChunk"),s.ended||(!s.decoder||(l=s.decoder.end())&&l.length&&(s.buffer.push(l),s.length+=s.objectMode?1:l.length),s.ended=!0,s.sync?f(a):(s.needReadable=!1,s.emittedReadable||(s.emittedReadable=!0,N(a))));else if(o=!i?function(e,t){var r;(function(e){return c.isBuffer(e)||e instanceof d})(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new h("chunk",["string","Buffer","Uint8Array"],t));return r}(u,t):o)m(e,o);else if(u.objectMode||t&&0<t.length)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===c.prototype||(l=t,t=c.from(l)),n)u.endEmitted?m(e,new v):E(e,u,t,!0);else if(u.ended)m(e,new y);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!r?(t=u.decoder.write(t),u.objectMode||0!==t.length?E(e,u,t,!1):T(e,u)):E(e,u,t,!1)}else n||(u.reading=!1,T(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function E(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&f(e)),T(e,t)}Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),r.prototype.destroy=e.destroy,r.prototype._undestroy=e.undestroy,r.prototype._destroy=function(e,t){t(e)},r.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),M(this,e,t,!1,r)},r.prototype.unshift=function(e){return M(this,e,null,!0,!1)},r.prototype.isPaused=function(){return!1===this._readableState.flowing},r.prototype.setEncoding=function(e){for(var t=new(o=o||q("string_decoder/").StringDecoder)(e),r=(this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding,this._readableState.buffer.head),n="";null!==r;)n+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var S=1073741824;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?(t.flowing&&t.length?t.buffer.head.data:t).length:(e>t.highWaterMark&&(t.highWaterMark=(S<=(r=e)?r=S:(r--,r=(r=(r=(r=(r|=r>>>1)|r>>>2)|r>>>4)|r>>>8)|r>>>16,r++),r)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var r}function f(e){var t=e._readableState;p("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(p("emitReadable",t.flowing),t.emittedReadable=!0,j.nextTick(N,e))}function N(e){var t=e._readableState;p("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,R(e)}function T(e,t){t.readingMore||(t.readingMore=!0,j.nextTick(I,e,t))}function I(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(p("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function k(e){var t=e._readableState;t.readableListening=0<e.listenerCount("readable"),t.resumeScheduled&&!t.paused?t.flowing=!0:0<e.listenerCount("data")&&e.resume()}function A(e){p("readable nexttick read 0"),e.read(0)}function O(e,t){p("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),R(e),t.flowing&&!t.reading&&e.read(0)}function R(e){var t=e._readableState;for(p("flow",t.flowing);t.flowing&&null!==e.read(););}function P(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function x(e){var t=e._readableState;p("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,j.nextTick(D,t,e))}function D(e,t){p("endReadableNT",e.endEmitted,e.length),e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"),!e.autoDestroy||(!(e=t._writableState)||e.autoDestroy&&e.finished)&&t.destroy())}function L(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}r.prototype.read=function(e){p("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:0<t.length)||t.ended))return p("read: emitReadable",t.length,t.ended),(0===t.length&&t.ended?x:f)(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&x(this),null;var n=t.needReadable;return p("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&p("length less than watermark",n=!0),t.ended||t.reading?p("reading or ended",n=!1):n&&(p("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(r,t))),null===(n=0<e?P(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&x(this)),null!==n&&this.emit("data",n),n},r.prototype._read=function(e){m(this,new b("_read()"))},r.prototype.pipe=function(r,e){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r)}i.pipesCount+=1,p("pipe count=%d opts=%j",i.pipesCount,e);e=(!e||!1!==e.end)&&r!==j.stdout&&r!==j.stderr?f:u;function c(e,t){p("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,p("cleanup"),r.removeListener("close",s),r.removeListener("finish",l),r.removeListener("drain",o),r.removeListener("error",a),r.removeListener("unpipe",c),n.removeListener("end",f),n.removeListener("end",u),n.removeListener("data",h),d=!0,!i.awaitDrain||r._writableState&&!r._writableState.needDrain||o())}function f(){p("onend"),r.end()}i.endEmitted?j.nextTick(e):n.once("end",e),r.on("unpipe",c);t=n;var t,o=function(){var e=t._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&g(t,"data")&&(e.flowing=!0,R(t))},d=(r.on("drain",o),!1);function h(e){p("ondata");e=r.write(e);p("dest.write",e),!1===e&&((1===i.pipesCount&&i.pipes===r||1<i.pipesCount&&-1!==L(i.pipes,r))&&!d&&(p("false write response, pause",i.awaitDrain),i.awaitDrain++),n.pause())}function a(e){p("onerror",e),u(),r.removeListener("error",a),0===g(r,"error")&&m(r,e)}function s(){r.removeListener("finish",l),u()}function l(){p("onfinish"),r.removeListener("close",s),u()}function u(){p("unpipe"),n.unpipe(r)}return n.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(r,"error",a),r.once("close",s),r.once("finish",l),r.emit("pipe",n),i.flowing||(p("pipe resume"),n.resume()),r},r.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=L(t.pipes,e);return-1===a||(t.pipes.splice(a,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},r.prototype.addListener=r.prototype.on=function(e,t){var t=i.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=0<this.listenerCount("readable"),!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,p("on readable",r.length,r.reading),r.length?f(this):r.reading||j.nextTick(A,this))),t},r.prototype.removeListener=function(e,t){t=i.prototype.removeListener.call(this,e,t);return"readable"===e&&j.nextTick(k,this),t},r.prototype.removeAllListeners=function(e){var t=i.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||j.nextTick(k,this),t},r.prototype.resume=function(){var e,t,r=this._readableState;return r.flowing||(p("resume"),r.flowing=!r.readableListening,e=this,(t=r).resumeScheduled||(t.resumeScheduled=!0,j.nextTick(O,e,t))),r.paused=!1,this},r.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},r.prototype.wrap=function(t){var e,r=this,n=this._readableState,i=!1;for(e in t.on("end",function(){var e;p("wrapped end"),!n.decoder||n.ended||(e=n.decoder.end())&&e.length&&r.push(e),r.push(null)}),t.on("data",function(e){p("wrapped data"),n.decoder&&(e=n.decoder.write(e)),n.objectMode&&null==e||(n.objectMode||e&&e.length)&&(r.push(e)||(i=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var o=0;o<_.length;o++)t.on(_[o],this.emit.bind(this,_[o]));return this._read=function(e){p("wrapped _read",e),i&&(i=!1,t.resume())},this},"function"==typeof Symbol&&(r.prototype[Symbol.asyncIterator]=function(){return(a=void 0===a?q("./internal/streams/async_iterator"):a)(this)}),Object.defineProperty(r.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(r.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(r.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),r._fromList=P,Object.defineProperty(r.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(r.from=function(e,t){return(s=void 0===s?q("./internal/streams/from"):s)(r,e,t)})}.call(this)}.call(this,q("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":41,"./_stream_duplex":42,"./internal/streams/async_iterator":47,"./internal/streams/buffer_list":48,"./internal/streams/destroy":49,"./internal/streams/from":51,"./internal/streams/state":53,"./internal/streams/stream":54,_process:36,buffer:22,events:32,inherits:34,"string_decoder/":55,util:21}],45:[function(e,t,c){"use strict";t.exports=s;var t=e("../errors").codes,n=t.ERR_METHOD_NOT_IMPLEMENTED,i=t.ERR_MULTIPLE_CALLBACK,o=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=t.ERR_TRANSFORM_WITH_LENGTH_0,r=e("./_stream_duplex");function s(e){if(!(this instanceof s))return new s(e);r.call(this,e),this._transformState={afterTransform:function(e,t){var r=this._transformState,n=(r.transforming=!1,r.writecb);if(null===n)return this.emit("error",new i);r.writechunk=null,(r.writecb=null)!=t&&this.push(t),n(e),(r=this._readableState).reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function l(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?u(this,null,null):this._flush(function(e,t){u(r,e,t)})}function u(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(s,r),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,r){r(new n("_transform()"))},s.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r,n.writechunk=e,n.writeencoding=t,n.transforming||(r=this._readableState,(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark))},s.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},s.prototype._destroy=function(e,t){r.prototype._destroy.call(this,e,function(e){t(e)})}},{"../errors":41,"./_stream_duplex":42,inherits:34}],46:[function(A,O,e){!function(I,k){!function(){"use strict";function m(o){var a=this;this.next=null,this.entry=null,this.finish=function(){var e=a,t=o,r=void 0,n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}}(O.exports=o).WritableState=i;var r,a={deprecate:A("util-deprecate")},s=A("./internal/streams/stream"),d=A("buffer").Buffer,g=k.Uint8Array||function(){};var n,e=A("./internal/streams/destroy"),l=A("./internal/streams/state").getHighWaterMark,t=A("../errors").codes,y=t.ERR_INVALID_ARG_TYPE,u=t.ERR_METHOD_NOT_IMPLEMENTED,b=t.ERR_MULTIPLE_CALLBACK,c=t.ERR_STREAM_CANNOT_PIPE,v=t.ERR_STREAM_DESTROYED,_=t.ERR_STREAM_NULL_VALUES,w=t.ERR_STREAM_WRITE_AFTER_END,M=t.ERR_UNKNOWN_ENCODING,h=e.errorOrDestroy;function E(){}function i(e,c,t){r=r||A("./_stream_duplex"),"boolean"!=typeof t&&(t=c instanceof r),this.objectMode=!!(e=e||{}).objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=l(this,e,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;t=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!t,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){var t=c,r=t._writableState,n=r.sync,i=r.writecb;if("function"!=typeof i)throw new b;var o,a,s,l,u=r;u.writing=!1,u.writecb=null,u.length-=u.writelen,u.writelen=0,e?(u=t,a=n,s=e,l=i,--(o=r).pendingcb,a?(I.nextTick(l,s),I.nextTick(f,u,o),u._writableState.errorEmitted=!0,h(u,s)):(l(s),u._writableState.errorEmitted=!0,h(u,s),f(u,o))):((e=N(r)||t.destroyed)||r.corked||r.bufferProcessing||!r.bufferedRequest||C(t,r),n?I.nextTick(S,t,r,e,i):S(t,r,e,i))},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new m(this)}A("inherits")(o,s),i.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};try{Object.defineProperty(i.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}function o(e){var t=this instanceof(r=r||A("./_stream_duplex"));if(!t&&!n.call(o,this))return new o(e);this._writableState=new i(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function p(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function S(e,t,r,n){var i;r||(r=e,0===(i=t).length&&i.needDrain&&(i.needDrain=!1,r.emit("drain"))),t.pendingcb--,n(),f(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){for(var n=t.bufferedRequestCount,i=new Array(n),n=t.corkedRequestsFree,o=(n.entry=r,0),a=!0;r;)(i[o]=r).isBuf||(a=!1),r=r.next,o+=1;i.allBuffers=a,p(e,t,!0,t.length,i,"",n.finish),t.pendingcb++,t.lastBufferedRequest=null,n.next?(t.corkedRequestsFree=n.next,n.next=null):t.corkedRequestsFree=new m(t),t.bufferedRequestCount=0}else{for(;r;){var s=r.chunk,l=r.encoding,u=r.callback;if(p(e,t,!1,t.objectMode?1:s.length,s,l,u),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function N(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(t,r){t._final(function(e){r.pendingcb--,e&&h(t,e),r.prefinished=!0,t.emit("prefinish"),f(t,r)})}function f(e,t){var r,n,i=N(t);return i&&(r=e,(n=t).prefinished||n.finalCalled||("function"!=typeof r._final||n.destroyed?(n.prefinished=!0,r.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,I.nextTick(T,r,n))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),!t.autoDestroy||(!(r=e._readableState)||r.autoDestroy&&r.endEmitted)&&e.destroy())),i}"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(n=Function.prototype[Symbol.hasInstance],Object.defineProperty(o,Symbol.hasInstance,{value:function(e){return!!n.call(this,e)||this===o&&(e&&e._writableState instanceof i)}})):n=function(e){return e instanceof this},o.prototype.pipe=function(){h(this,new c)},o.prototype.write=function(e,t,r){var n,c,i,o,a,s,l=this._writableState,f=!1,u=!l.objectMode&&(u=e,d.isBuffer(u)||u instanceof g);return u&&!d.isBuffer(e)&&(o=e,e=d.from(o)),"function"==typeof t&&(r=t,t=null),t=u?"buffer":t||l.defaultEncoding,"function"!=typeof r&&(r=E),l.ending?(o=this,a=r,s=new w,h(o,s),I.nextTick(a,s)):!u&&(a=this,s=l,c=r,null===(n=e)?i=new _:"string"==typeof n||s.objectMode||(i=new y("chunk",["string","Buffer"],n)),i&&(h(a,i),!void I.nextTick(c,i)))||(l.pendingcb++,f=function(e,t,r,n,i,o){r||(a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,r));return t}(t,n,i),n!==a&&(r=!0,i="buffer",n=a));var a=t.objectMode?1:n.length,s=(t.length+=a,t.length<t.highWaterMark);s||(t.needDrain=!0);{var l;t.writing||t.corked?(l=t.lastBufferedRequest,t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1):p(e,t,!1,a,n,i,o)}return s}(this,l,u,e,t,r)),f},o.prototype.cork=function(){this._writableState.corked++},o.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},o.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new M(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),o.prototype._write=function(e,t,r){r(new u("_write()"))},o.prototype._writev=null,o.prototype.end=function(e,t,r){var n=this._writableState;if("function"==typeof e?(r=e,t=e=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),!n.ending){e=this,t=n,n=r;t.ending=!0,f(e,t),n&&(t.finished?I.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}return this},Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),o.prototype.destroy=e.destroy,o.prototype._undestroy=e.undestroy,o.prototype._destroy=function(e,t){t(e)}}.call(this)}.call(this,A("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":41,"./_stream_duplex":42,"./internal/streams/destroy":49,"./internal/streams/state":53,"./internal/streams/stream":54,_process:36,buffer:22,inherits:34,"util-deprecate":57}],47:[function(n,g,e){!function(m){!function(){"use strict";var e;function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d=n("./end-of-stream"),i=Symbol("lastResolve"),o=Symbol("lastReject"),a=Symbol("error"),s=Symbol("ended"),l=Symbol("lastPromise"),u=Symbol("handlePromise"),c=Symbol("stream");function f(e,t){return{value:e,done:t}}function h(e){var t,r=e[i];null===r||null!==(t=e[c].read())&&(e[l]=null,e[i]=null,e[o]=null,r(f(t,!1)))}var t=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((r(e={get stream(){return this[c]},next:function(){var r=this,e=this[a];if(null!==e)return Promise.reject(e);if(this[s])return Promise.resolve(f(void 0,!0));if(this[c].destroyed)return new Promise(function(e,t){m.nextTick(function(){r[a]?t(r[a]):e(f(void 0,!0))})});var t,n,i,e=this[l];if(e)t=new Promise((n=e,i=this,function(e,t){n.then(function(){i[s]?e(f(void 0,!0)):i[u](e,t)},t)}));else{e=this[c].read();if(null!==e)return Promise.resolve(f(e,!1));t=new Promise(this[u])}return this[l]=t}},Symbol.asyncIterator,function(){return this}),r(e,"return",function(){var e=this;return new Promise(function(t,r){e[c].destroy(null,function(e){e?r(e):t(f(void 0,!0))})})}),e),t);g.exports=function(e){var t,n=Object.create(p,(r(t={},c,{value:e,writable:!0}),r(t,i,{value:null,writable:!0}),r(t,o,{value:null,writable:!0}),r(t,a,{value:null,writable:!0}),r(t,s,{value:e._readableState.endEmitted,writable:!0}),r(t,u,{value:function(e,t){var r=n[c].read();r?(n[l]=null,n[i]=null,n[o]=null,e(f(r,!1))):(n[i]=e,n[o]=t)},writable:!0}),t));return n[l]=null,d(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code)return null!==(t=n[o])&&(n[l]=null,n[i]=null,n[o]=null,t(e)),void(n[a]=e);var t=n[i];null!==t&&(n[l]=null,n[i]=null,t(f(void 0,!(n[o]=null)))),n[s]=!0}),e.on("readable",function(e){m.nextTick(h,e)}.bind(null,n)),n}}.call(this)}.call(this,n("_process"))},{"./end-of-stream":50,_process:36}],48:[function(e,t,r){"use strict";function o(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function i(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=e("buffer").Buffer,l=e("util").inspect,u=l&&l.custom||"inspect";t.exports=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.head=null,this.tail=null,this.length=0}var t,r,n;return t=e,(r=[{key:"push",value:function(e){e={data:e,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(e){e={data:e,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){var e;if(0!==this.length)return e=this.head.data,1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,r,n=s.allocUnsafe(e>>>0),i=this.head,o=0;i;)t=i.data,r=o,s.prototype.copy.call(t,n,r),o+=i.data.length,i=i.next;return n}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?n+=i:n+=i.slice(0,e),0===(e-=o)){o===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t).data=i.slice(o);break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0===(e-=o)){o===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r).data=i.slice(o);break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return l(this,i({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),n&&a(t,n),e}()},{buffer:22,util:21}],49:[function(e,t,r){!function(l){!function(){"use strict";function o(e,t){s(e,t),a(e)}function a(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,l.nextTick(s,this,e)):l.nextTick(s,this,e)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?r._writableState?r._writableState.errorEmitted?l.nextTick(a,r):(r._writableState.errorEmitted=!0,l.nextTick(o,r,e)):l.nextTick(o,r,e):t?(l.nextTick(a,r),t(e)):l.nextTick(a,r)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}.call(this)}.call(this,e("_process"))},{_process:36}],50:[function(e,t,r){"use strict";var y=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function b(){}t.exports=function c(t,e,r){if("function"==typeof e)return c(t,null,e);function n(){t.writable||i()}function i(){m=!(u=!1),l||r.call(t)}function f(){g=!(l=!1),u||r.call(t)}function d(e){r.call(t,e)}function o(){var e;return l&&!g?(t._readableState&&t._readableState.ended||(e=new y),r.call(t,e)):u&&!m?(t._writableState&&t._writableState.ended||(e=new y),r.call(t,e)):void 0}function a(){t.req.on("finish",i)}h=r||b,s=!1,r=function(){if(!s){s=!0;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];h.apply(this,t)}};var h,s,p,l=(e=e||{}).readable||!1!==e.readable&&t.readable,u=e.writable||!1!==e.writable&&t.writable,m=t._writableState&&t._writableState.finished,g=t._readableState&&t._readableState.endEmitted;return(p=t).setHeader&&"function"==typeof p.abort?(t.on("complete",i),t.on("abort",o),t.req?a():t.on("request",a)):u&&!t._writableState&&(t.on("end",n),t.on("close",n)),t.on("end",f),t.on("finish",i),!1!==e.error&&t.on("error",d),t.on("close",o),function(){t.removeListener("complete",i),t.removeListener("abort",o),t.removeListener("request",a),t.req&&t.req.removeListener("finish",i),t.removeListener("end",n),t.removeListener("close",n),t.removeListener("finish",i),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",o)}}},{"../../../errors":41}],51:[function(e,t,r){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],52:[function(l,e,r){"use strict";var u;var t=l("../../../errors").codes,s=t.ERR_MISSING_ARGS,c=t.ERR_STREAM_DESTROYED;function f(e){if(e)throw e}function d(r,e,t,n){i=n,o=!1;var i,o,a=!(n=function(){o||(o=!0,i.apply(void 0,arguments))}),s=(r.on("close",function(){a=!0}),(u=void 0===u?l("./end-of-stream"):u)(r,{readable:e,writable:t},function(e){return e?n(e):(a=!0,void n())}),!1);return function(e){var t;if(!a&&!s)return s=!0,(t=r).setHeader&&"function"==typeof t.abort?r.abort():"function"==typeof r.destroy?r.destroy():void n(e||new c("pipe"))}}function h(e){e()}function p(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];var r,i,o=!(r=n).length||"function"!=typeof r[r.length-1]?f:r.pop();if((n=Array.isArray(n[0])?n[0]:n).length<2)throw new s("streams");var a=n.map(function(e,t){var r=t<n.length-1;return d(e,r,0<t,function(e){i=i||e,e&&a.forEach(h),r||(a.forEach(h),o(i))})});return n.reduce(p)}},{"../../../errors":41,"./end-of-stream":50}],53:[function(e,t,r){"use strict";var a=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,n){o=n,i=r;var i,o=null!=(t=t).highWaterMark?t.highWaterMark:o?t[i]:null;if(null==o)return e.objectMode?16:16384;if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new a(n?r:"highWaterMark",o);return Math.floor(o)}}},{"../../../errors":41}],54:[function(e,t,r){t.exports=e("events").EventEmitter},{events:32}],55:[function(e,c,t){"use strict";var r=e("safe-buffer").Buffer,n=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){var t;switch(this.encoding=i(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=f,this.end=d,t=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t,r=this.lastTotal-this.lastNeed,n=(t=this,128!=(192&(n=e)[0])?(t.lastNeed=0,"�"):1<t.lastNeed&&1<n.length?128!=(192&n[1])?(t.lastNeed=1,"�"):2<t.lastNeed&&2<n.length&&128!=(192&n[2])?(t.lastNeed=2,"�"):void 0:void 0);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,r,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);t=e.toString("utf16le",t);if(t){var r=t.charCodeAt(t.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}function u(e){var t,e=e&&e.length?this.write(e):"";return this.lastNeed?(t=this.lastTotal-this.lastNeed,e+this.lastChar.toString("utf16le",0,t)):e}function f(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function d(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function h(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}(t.StringDecoder=o).prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"�":e},o.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=a(t[n]);if(0<=i)return 0<i&&(e.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if(0<=(i=a(t[n])))return 0<i&&(e.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if(0<=(i=a(t[n])))return 0<i&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;r=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":37}],56:[function(l,e,u){!function(r,s){!function(){var n=l("process/browser.js").nextTick,e=Function.prototype.apply,i=Array.prototype.slice,o={},a=0;function t(e,t){this._id=e,this._clearFn=t}u.setTimeout=function(){return new t(e.call(setTimeout,window,arguments),clearTimeout)},u.setInterval=function(){return new t(e.call(setInterval,window,arguments),clearInterval)},u.clearTimeout=u.clearInterval=function(e){e.close()},t.prototype.unref=t.prototype.ref=function(){},t.prototype.close=function(){this._clearFn.call(window,this._id)},u.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},u.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},u._unrefActive=u.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},u.setImmediate="function"==typeof r?r:function(e){var t=a++,r=!(arguments.length<2)&&i.call(arguments,1);return o[t]=!0,n(function(){o[t]&&(r?e.apply(null,r):e.call(null),u.clearImmediate(t))}),t},u.clearImmediate="function"==typeof s?s:function(e){delete o[e]}}.call(this)}.call(this,l("timers").setImmediate,l("timers").clearImmediate)},{"process/browser.js":36,timers:56}],57:[function(e,r,t){!function(t){!function(){function n(e){try{if(!t.localStorage)return}catch(e){return}e=t.localStorage[e];return null!=e&&"true"===String(e).toLowerCase()}r.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[5]);
//# sourceMappingURL=bundle.js.map
