{"name":"Barge Events","type":"script","author":"hNHeJbKl47AOkoOO","img":"Images/Icons/Age%20of%20Reckoning%20Icons/EU/Market_Control.jpg","scope":"global","command":"await game.tables.getName('Barge Events').draw();","folder":null,"sort":0,"permission":{"default":0,"hNHeJbKl47AOkoOO":3},"flags":{"core":{"sourceId":"Macro.FFyOGMISGj0dxKOk"}},"_id":"5DFbdSomxiTRjWlf"}
{"name":"Downtime Events","type":"script","author":"hNHeJbKl47AOkoOO","img":"Images/Icons/Age%20of%20Reckoning%20Icons/Treasure/4542.png","scope":"global","command":"await game.tables.getName('Downtime Events').draw();","folder":null,"sort":0,"permission":{"default":0,"hNHeJbKl47AOkoOO":3},"flags":{"core":{"sourceId":"Macro.J4BfD26N5V7jGFbC"}},"_id":"cd1bZSGGFfcBYnFk"}
{"name":"Reset Fortune","type":"script","author":"hNHeJbKl47AOkoOO","img":"modules/wfrp4e-gm-toolkit/assets/icons/reset-fortune.svg","scope":"global","command":"resetFortune();\n\nfunction resetFortune() {\n// setup: exit with notice if there are no player-owned characters\n\tparty = Array.from(game.actors).filter(pc => pc.hasPlayerOwner && pc.type == 'character'); \n\tif (party.length == 0) return ui.notifications.error(game.i18n.localize(\"GMTOOLKIT.ResetFortune.NoPlayerCharacters\")); \n\tlet chatContent = \"\"\n\n// cycle through player characters, updating Fortune and building a report message\n\tparty.forEach (character => {\n\t\tcurrentFortune = character.data.data.status.fortune.value\n\t\tmaxFortune = getMaxFortune(character);\n\t\tcharacter.update({'data.status.fortune.value': maxFortune})\n\t\tchatContent += `${character.name}:  ${currentFortune} -> ${maxFortune} <br>`\n\t});\n\n// confirm changes made in chat\n\tlet chatData = {\n\t\tuser: game.user.id,\n\t\tcontent: chatContent, \n\t\tflavor: game.i18n.localize(\"GMTOOLKIT.ResetFortune.Restored\") \n\t};\n\tChatMessage.create(chatData, {});  \n}\n\n// Calculate the Fortune target to be restored, based on Fate and Luck talent advances\nfunction getMaxFortune(target) {\n    let advLuck = 0;\n    let item = target.items.find(i => i.name === game.i18n.localize(\"GMTOOLKIT.Talent.Luck\") )\n\tif(!(item == undefined || item.data.data.advances.value < 1)) { \n\t\tfor (let item of target.items)\n\t\t\t{\n\t\t\t\tif (item.type == \"talent\" && item.name == game.i18n.localize(\"GMTOOLKIT.Talent.Luck\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tadvLuck += item.data.data.advances.value;\n\t\t\t\t\t}\n\t\t\t}\n\t\t} \n    return  target.status.fate.value + advLuck\n}\n\n/* ==========\n * MACRO: Reset Fortune\n * VERSION: 0.8.0\n * UPDATED: 2021-11-12\n * DESCRIPTION: Restores Fortune to the Fate level of player character(s). Applies any Luck talent bonus.\n * TIP: Characters must have a player assigned. \n ========== */","folder":null,"sort":0,"permission":{"default":0,"hNHeJbKl47AOkoOO":3},"flags":{"core":{"sourceId":"Compendium.wfrp4e-gm-toolkit.gm-toolkit-macros.pZmPtsEZHOpyJfnq"}},"_id":"LBoOqUmDXG7iGrjt"}
{"name":"Coin Flip","type":"chat","author":"hNHeJbKl47AOkoOO","img":"icons/svg/coins.svg","scope":"global","command":"/roll 1dc","folder":null,"sort":0,"permission":{"default":0,"hNHeJbKl47AOkoOO":3},"flags":{"core":{"sourceId":"Macro.cHu0psp9Sl07vWRV"}},"_id":"SNIsIH4Cu7L7ueZS"}
{"$$deleted":true,"_id":"SNIsIH4Cu7L7ueZS"}
{"name":"Coin Flip","type":"chat","author":"hNHeJbKl47AOkoOO","img":"Images/Icons/Age%20of%20Reckoning%20Icons/EU/Mission_reform_the_state.png","scope":"global","command":"/roll 1dc","folder":null,"sort":0,"permission":{"default":0,"hNHeJbKl47AOkoOO":3},"flags":{"core":{"sourceId":"Macro.cHu0psp9Sl07vWRV"}},"_id":"BJ1PZTDUVJD3sdKA"}
{"name":"Add Advantage","type":"script","author":"hNHeJbKl47AOkoOO","img":"modules/wfrp4e-gm-toolkit/assets/icons/advantage-add.svg","scope":"global","command":"/* Increases Advantage for the selected token by 1.\n * Caps at character's maximum advantage. \n*/\n\ngame.gmtoolkit.advantage.updateAdvantage(token,\"increase\");","folder":null,"sort":0,"permission":{"default":0,"hNHeJbKl47AOkoOO":3},"flags":{"core":{"sourceId":"Compendium.wfrp4e-gm-toolkit.gm-toolkit-macros.AjUYYy7qAN55BERN"}},"_id":"rlwLn6eXvq6QiEiE"}
{"name":"Reduce Advantage","type":"script","author":"hNHeJbKl47AOkoOO","img":"modules/wfrp4e-gm-toolkit/assets/icons/advantage-reduce.svg","scope":"global","command":"/* Reduces Advantage for the selected token by 1 (to minimum 0).\n*/\n\ngame.gmtoolkit.advantage.updateAdvantage(token,\"reduce\");","folder":null,"sort":0,"permission":{"default":0,"hNHeJbKl47AOkoOO":3},"flags":{"core":{"sourceId":"Compendium.wfrp4e-gm-toolkit.gm-toolkit-macros.2sefSFqqAbySw2nz"}},"_id":"KJYNIBTzHgNb8BU0"}
{"$$deleted":true,"_id":"rlwLn6eXvq6QiEiE"}
{"$$deleted":true,"_id":"KJYNIBTzHgNb8BU0"}
